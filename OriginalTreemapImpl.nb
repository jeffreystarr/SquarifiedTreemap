(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     75964,       2286]
NotebookOptionsPosition[     70406,       2098]
NotebookOutlinePosition[     70743,       2113]
CellTagsIndexPosition[     70700,       2110]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Treemap", "Title",
 CellChangeTimes->{{3.602097181710555*^9, 3.602097182579525*^9}}],

Cell["2013-02-22 Jeffrey Starr", "Subtitle",
 CellChangeTimes->{{3.6020971910830173`*^9, 3.6020972005609283`*^9}}],

Cell[CellGroupData[{

Cell["Abstract", "Section",
 CellChangeTimes->{{3.6020972232403927`*^9, 3.6020972240912437`*^9}}],

Cell["\<\
Prior to implementing a treemap visualization in nvd3, this notebook will \
implement and test the treemap algorithm in order to demonstrate my \
understanding of the system.\
\>", "Text",
 CellChangeTimes->{{3.602097226883245*^9, 3.602097266265235*^9}, {
  3.602097297630341*^9, 3.602097320505767*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Data", "Section",
 CellChangeTimes->{{3.602097328583703*^9, 3.602097328952342*^9}}],

Cell["\<\
Treemaps represent hierarchical data. Hierarchical data can be modeled as a \
tree, where each node represents a grouping of the data or, in the case of \
terminal nodes, the \[OpenCurlyDoubleQuote]size\[CloseCurlyDoubleQuote]  or \
\[OpenCurlyDoubleQuote]count\[CloseCurlyDoubleQuote] of that grouping.\
\>", "Text",
 CellChangeTimes->{{3.602097333270603*^9, 3.602097414969624*^9}}],

Cell["\<\
Data is provided as a list of lists, with the individual child lists \
containing a sequence of vertex labels (categories) and the final value in \
the list being a weight (number). For example:\
\>", "Text",
 CellChangeTimes->{{3.6020977663056507`*^9, 3.602097829763893*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"smallSampleData", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<a\>\"", ",", "\"\<c\>\"", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<a\>\"", ",", "\"\<d\>\"", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<b\>\"", ",", "\"\<c\>\"", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\"\<b\>\"", ",", "\"\<d\>\"", ",", "6"}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.60209783195765*^9, 3.60209787652866*^9}, {
  3.602097914024004*^9, 3.602097916304674*^9}}],

Cell["\<\
All child lists must be of the same length and each path must be unique.\
\>", "Text",
 CellChangeTimes->{{3.602097962698473*^9, 3.602097985613433*^9}}],

Cell[TextData[{
 "These child lists will be translated into a recursive list structure. The \
first element of each list will be the node name (with the top element being ",
 StyleBox["root",
  FontSlant->"Italic"],
 ") and the second element will either be a list of child nodes or a number \
for the weight."
}], "Text",
 CellChangeTimes->{{3.602099714699561*^9, 3.6020997963370743`*^9}, {
  3.602103457875136*^9, 3.6021034780128517`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ToRecursiveTreeForm", "[", "paths_", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"{", 
   RowBox[{"\"\<root\>\"", ",", 
    RowBox[{"ChildrenOf", "[", "paths", "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.6020998001301947`*^9, 3.602099856122221*^9}, {
  3.602100886224515*^9, 3.602100892370318*^9}, {3.602103481009788*^9, 
  3.602103491551063*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChildrenOf", "[", "paths_", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Switch", "[", 
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"First", "[", "paths", "]"}], "]"}], ",", "\[IndentingNewLine]", 
    "2", ",", "\[IndentingNewLine]", 
    RowBox[{"Table", "[", 
     RowBox[{"path", ",", 
      RowBox[{"{", 
       RowBox[{"path", ",", "paths"}], "}"}]}], "]"}], ",", 
    "\[IndentingNewLine]", "_", ",", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"heads", "=", 
        RowBox[{"Union", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"First", "[", "#", "]"}], "&"}], "/@", "paths"}], "]"}]}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"#", ",", "\[IndentingNewLine]", 
          RowBox[{"ChildrenOf", "[", 
           RowBox[{"Cases", "[", 
            RowBox[{"paths", ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"#", ",", "rest__"}], "}"}], "\[Rule]", 
              RowBox[{"{", "rest", "}"}]}]}], "]"}], "]"}]}], "}"}], "&"}], "/@",
        "heads"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.602099857891039*^9, 3.6020999763840017`*^9}, {
  3.602100058908915*^9, 3.6021001334661493`*^9}, {3.602100405057094*^9, 
  3.602100424695375*^9}, {3.602100512268601*^9, 3.602100710136636*^9}, {
  3.602100740906188*^9, 3.6021007728005342`*^9}, {3.6021008275013323`*^9, 
  3.6021008369568872`*^9}, {3.6021034997399282`*^9, 3.602103542308896*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ToRecursiveTreeForm", "[", "smallSampleData", "]"}]], "Input",
 CellChangeTimes->{{3.602100137768849*^9, 3.602100141144767*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"root\"\>", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\<\"a\"\>", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\<\"c\"\>", ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\<\"d\"\>", ",", "4"}], "}"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\<\"b\"\>", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\<\"c\"\>", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\<\"d\"\>", ",", "6"}], "}"}]}], "}"}]}], "}"}]}], "}"}]}],
   "}"}]], "Output",
 CellChangeTimes->{
  3.602100148117331*^9, 3.602100428528853*^9, {3.602100518348382*^9, 
   3.602100565718236*^9}, {3.602100601263112*^9, 3.6021006575951014`*^9}, {
   3.60210068956527*^9, 3.6021007120612793`*^9}, 3.602100774870234*^9, 
   3.6021008395886374`*^9, 3.602100895324545*^9, {3.602103517871876*^9, 
   3.602103545319195*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TreeForm", "[", "%95", "]"}]], "Input",
 CellChangeTimes->{{3.602100913035778*^9, 3.602100917215616*^9}, {
  3.602103571316465*^9, 3.602103573349654*^9}}],

Cell[BoxData[
 GraphicsBox[
  TagBox[GraphicsComplexBox[CompressedData["
1:eJxTTMoPSmViYGAQBWIQbTMn7Swj2z97CM3nYLDhte05lh/2EJrDQeVIwbpZ
zEwOMD6EfmGPKn7DHqYPIv7JHtUcmPwLewY0gC4Ocw9MHGYOTB5mL6p6Prg7
zdRWsmawcsP9ocg56ZRvswCcjyr/Au5PdPNgfPV6/0nPm4XR/C0El9ey0isz
YRGF8wGNqW6V
    "], {
     {RGBColor[0.55, 0.45, 0.45], 
      LineBox[{{1, 2}, {1, 3}, {3, 4}, {3, 13}, {4, 5}, {4, 6}, {6, 7}, {6, 
       10}, {7, 8}, {7, 9}, {10, 11}, {10, 12}, {13, 14}, {13, 15}, {15, 
       16}, {15, 19}, {16, 17}, {16, 18}, {19, 20}, {19, 21}}]}, {
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 1],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"root\"", ",", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", 
                   RowBox[{"\"a\"", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"c\"", ",", "3"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"d\"", ",", "4"}], "}"}]}], "}"}]}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"\"b\"", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"c\"", ",", "2"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"d\"", ",", "6"}], "}"}]}], "}"}]}], "}"}]}], 
               "}"}]}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{
         "root", {{"a", {{"c", 3}, {"d", 4}}}, {"b", {{"c", 2}, {"d", 6}}}}}],
         "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"root\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 2],
        TagBox["\"root\"", HoldForm]],
       Annotation[#, 
        HoldForm["root"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 3],
        TagBox[
         RowBox[{"{", 
           RowBox[{
             RowBox[{"{", 
               RowBox[{"\"a\"", ",", 
                 RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"c\"", ",", "3"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"d\"", ",", "4"}], "}"}]}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
               RowBox[{"\"b\"", ",", 
                 RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"c\"", ",", "2"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\"d\"", ",", "6"}], "}"}]}], "}"}]}], "}"}]}], 
           "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{{"a", {{"c", 3}, {"d", 4}}}, {"b", {{"c", 2}, {"d", 6}}}}], 
        "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 4],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"a\"", ",", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", 
                   RowBox[{"\"c\"", ",", "3"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"\"d\"", ",", "4"}], "}"}]}], "}"}]}], "}"}], 
         HoldForm]],
       Annotation[#, 
        HoldForm[{"a", {{"c", 3}, {"d", 4}}}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"a\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 5],
        TagBox["\"a\"", HoldForm]],
       Annotation[#, 
        HoldForm["a"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 6],
        TagBox[
         RowBox[{"{", 
           RowBox[{
             RowBox[{"{", 
               RowBox[{"\"c\"", ",", "3"}], "}"}], ",", 
             RowBox[{"{", 
               RowBox[{"\"d\"", ",", "4"}], "}"}]}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{{"c", 3}, {"d", 4}}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 7],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"c\"", ",", "3"}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{"c", 3}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"c\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 8],
        TagBox["\"c\"", HoldForm]],
       Annotation[#, 
        HoldForm["c"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["3",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 9],
        TagBox["3", HoldForm]],
       Annotation[#, 
        HoldForm[3], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 10],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"d\"", ",", "4"}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{"d", 4}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"d\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 11],
        TagBox["\"d\"", HoldForm]],
       Annotation[#, 
        HoldForm["d"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["4",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 12],
        TagBox["4", HoldForm]],
       Annotation[#, 
        HoldForm[4], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 13],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"b\"", ",", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", 
                   RowBox[{"\"c\"", ",", "2"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"\"d\"", ",", "6"}], "}"}]}], "}"}]}], "}"}], 
         HoldForm]],
       Annotation[#, 
        HoldForm[{"b", {{"c", 2}, {"d", 6}}}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"b\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 14],
        TagBox["\"b\"", HoldForm]],
       Annotation[#, 
        HoldForm["b"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 15],
        TagBox[
         RowBox[{"{", 
           RowBox[{
             RowBox[{"{", 
               RowBox[{"\"c\"", ",", "2"}], "}"}], ",", 
             RowBox[{"{", 
               RowBox[{"\"d\"", ",", "6"}], "}"}]}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{{"c", 2}, {"d", 6}}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 16],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"c\"", ",", "2"}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{"c", 2}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"c\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 17],
        TagBox["\"c\"", HoldForm]],
       Annotation[#, 
        HoldForm["c"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["2",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 18],
        TagBox["2", HoldForm]],
       Annotation[#, 
        HoldForm[2], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 19],
        TagBox[
         RowBox[{"{", 
           RowBox[{"\"d\"", ",", "6"}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{"d", 6}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["\<\"d\"\>",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 20],
        TagBox["\"d\"", HoldForm]],
       Annotation[#, 
        HoldForm["d"], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["6",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 21],
        TagBox["6", HoldForm]],
       Annotation[#, 
        HoldForm[6], "Tooltip"]& ]}}],
   Annotation[#, VertexCoordinateRules -> CompressedData["
1:eJxTTMoPSmViYGAQBWIQbTMn7Swj2z97CM3nYLDhte05lh/2EJrDQeVIwbpZ
zEwOMD6EfmGPKn7DHqYPIv7JHtUcmPwLewY0gC4Ocw9MHGYOTB5mL6p6Prg7
zdRWsmawcsP9ocg56ZRvswCcjyr/Au5PdPNgfPV6/0nPm4XR/C0El9ey0isz
YRGF8wGNqW6V
     "]]& ],
  AspectRatio->NCache[Rational[1, 2] 3^Rational[1, 2], 0.8660254037844386],
  FrameTicks->Automatic,
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{3.60210091764282*^9, 3.602103574096808*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Accessing Information", "Section",
 CellChangeTimes->{{3.602103602087002*^9, 3.602103606907917*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChildrenArea", "[", 
   RowBox[{"{", 
    RowBox[{"_String", ",", "weight_"}], "}"}], "]"}], ":=", 
  "weight"}]], "Input",
 CellChangeTimes->{{3.6021036524004917`*^9, 3.602103674846467*^9}, {
  3.6021038845110598`*^9, 3.602103885654243*^9}, {3.602104024426366*^9, 
  3.602104025538734*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChildrenArea", "[", 
   RowBox[{"{", 
    RowBox[{"_String", ",", "children_List"}], "}"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Total", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ChildrenArea", "[", "#", "]"}], "&"}], "/@", "children"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.602103629682643*^9, 3.6021036370328503`*^9}, {
  3.602103685801278*^9, 3.602103758296472*^9}, {3.6021038276446133`*^9, 
  3.6021038310518217`*^9}, {3.602103890105332*^9, 3.6021038908229017`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ChildrenArea", "[", 
  RowBox[{"ToRecursiveTreeForm", "[", "smallSampleData", "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.602103734154729*^9, 3.602103737852582*^9}, {
  3.602103858120895*^9, 3.602103862018688*^9}}],

Cell[BoxData["15"], "Output",
 CellChangeTimes->{{3.6021037383985577`*^9, 3.602103760418379*^9}, {
   3.602103835534564*^9, 3.6021038632444477`*^9}, 3.6021038933660517`*^9, 
   3.602103928725925*^9, 3.6021040299432507`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Rectangles", "Subsection",
 CellChangeTimes->{{3.60237018116641*^9, 3.602370183519033*^9}}],

Cell[TextData[{
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " provides a Rectangle object, which is defined by the pair of points ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["x", "min"], ",", 
     SubscriptBox["y", "min"]}], ")"}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["x", "max"], ",", 
      SubscriptBox["y", "max"]}], ")"}], "."}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " We provide a few useful functions:"
}], "Text",
 CellChangeTimes->{{3.6023699622989388`*^9, 3.602370052781747*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Width", "[", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"xmin_", ",", "ymin_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"xmax_", ",", "ymax_"}], "}"}]}], "]"}], "]"}], ":=", 
  RowBox[{"Abs", "[", 
   RowBox[{"xmax", "-", "xmin"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.602370055534333*^9, 3.602370083421372*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Height", "[", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"xmin_", ",", "ymin_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"xmax_", ",", "ymax_"}], "}"}]}], "]"}], "]"}], ":=", 
  RowBox[{"Abs", "[", 
   RowBox[{"ymax", "-", "ymin"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.602370086103395*^9, 3.602370106053975*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Area", "[", "r_Rectangle", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Width", "[", "r", "]"}], "\[Times]", 
   RowBox[{"Height", "[", "r", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6021093533928328`*^9, 3.602109355190353*^9}, {
  3.6021094142519608`*^9, 3.602109464481868*^9}, {3.602370112041954*^9, 
  3.602370150639126*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RectLeft", "[", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"xmin_", ",", "ymin_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"xmax_", ",", "ymax_"}], "}"}]}], "]"}], "]"}], ":=", 
  "xmin"}]], "Input",
 CellChangeTimes->{{3.602371505663761*^9, 3.6023715262402143`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RectRight", "[", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"xmin_", ",", "ymin_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"xmax_", ",", "ymax_"}], "}"}]}], "]"}], "]"}], ":=", 
  "xmax"}]], "Input",
 CellChangeTimes->{{3.602371764881976*^9, 3.602371777066785*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RectTop", "[", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"xmin_", ",", "ymin_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"xmax_", ",", "ymax_"}], "}"}]}], "]"}], "]"}], ":=", 
  "ymax"}]], "Input",
 CellChangeTimes->{{3.6023717786354923`*^9, 3.602371785926364*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RectBottom", "[", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"xmin_", ",", "ymin_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"xmax_", ",", "ymax_"}], "}"}]}], "]"}], "]"}], ":=", 
  "ymin"}]], "Input",
 CellChangeTimes->{{3.6023717882871513`*^9, 3.6023717972889967`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Area", "[", 
  RowBox[{"Rectangle", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"4", ",", "9"}], "}"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.60210946656712*^9, 3.6021094838694963`*^9}}],

Cell[BoxData["18"], "Output",
 CellChangeTimes->{3.6021094844194593`*^9, 3.602370155176889*^9}]
}, Open  ]],

Cell["\<\
The aspect ratio of a rectangle is the ratio of the longer edge to the \
shorter edge. If either edge has a zero length, this function returns \
infinity.\
\>", "Text",
 CellChangeTimes->{{3.602370375707459*^9, 3.602370417250532*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RectAspectRatio", "[", "r_Rectangle", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Width", "[", "r", "]"}], "\[Equal]", "0"}], "\[Or]", 
     RowBox[{
      RowBox[{"Height", "[", "r", "]"}], "\[Equal]", "0"}]}], ",", 
    "\[Infinity]", ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Width", "[", "r", "]"}], ">", 
       RowBox[{"Height", "[", "r", "]"}]}], ",", 
      RowBox[{
       RowBox[{"Width", "[", "r", "]"}], "/", 
       RowBox[{"Height", "[", "r", "]"}]}], ",", 
      RowBox[{
       RowBox[{"Height", "[", "r", "]"}], "/", 
       RowBox[{"Width", "[", "r", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.602370202217968*^9, 3.602370210136307*^9}, {
  3.602370274203534*^9, 3.6023703675481997`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RectAspectRatio", "[", 
  RowBox[{"Rectangle", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"3", "/", "2"}], ",", "4"}], "}"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6023707550399227`*^9, 3.602370776915351*^9}}],

Cell[BoxData[
 FractionBox["8", "3"]], "Output",
 CellChangeTimes->{3.602370777557145*^9}]
}, Open  ]],

Cell["\<\
Subrectangles may be placed in either Horizontal or Vertical orientation. \
This function flips between the two.\
\>", "Text",
 CellChangeTimes->{{3.6025102446212797`*^9, 3.602510264521669*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"InvertOrientation", "[", "Horizontal", "]"}], ":=", 
  "Vertical"}]], "Input",
 CellChangeTimes->{{3.6025102657759933`*^9, 3.602510272872867*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"InvertOrientation", "[", "Vertical", "]"}], ":=", 
  "Horizontal"}]], "Input",
 CellChangeTimes->{{3.6025102744337053`*^9, 3.602510283296165*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Filling in a Rectangle", "Section",
 CellChangeTimes->{{3.6023709348477497`*^9, 3.602370951652197*^9}}],

Cell["\<\
The squarified algorithm works by recursively filling in rectangles with \
smaller rectangles by balancing the aspect ratio of the filled in area.\
\>", "Text",
 CellChangeTimes->{{3.6023709570671387`*^9, 3.602371011068289*^9}}],

Cell["\<\
This function returns a list of sub-rectangles given a list of areas (the \
list of areas must be less than or equal to the area of the parent rectangle) \
and an orientation.\
\>", "Text",
 CellChangeTimes->{{3.60237102495828*^9, 3.602371081803873*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FillRectangle", "[", 
   RowBox[{"parent_Rectangle", ",", 
    RowBox[{"{", "}"}], ",", "Vertical"}], "]"}], ":=", 
  RowBox[{"{", "}"}]}]], "Input",
 CellChangeTimes->{{3.6023710932368107`*^9, 3.602371180842791*^9}, {
  3.6023712362204037`*^9, 3.602371242982777*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FillRectangle", "[", 
   RowBox[{"parent_Rectangle", ",", "areas_List", ",", "Vertical"}], "]"}], ":=",
   "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"heights", "=", 
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Height", "[", "parent", "]"}], "*", 
         RowBox[{
          RowBox[{"Accumulate", "[", "areas", "]"}], "/", 
          RowBox[{"Total", "[", "areas", "]"}]}]}], ",", "0"}], "]"}]}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Rectangle", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"RectLeft", "[", "parent", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"RectBottom", "[", "parent", "]"}], "+", 
           RowBox[{"heights", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"RectLeft", "[", "parent", "]"}], "+", 
           RowBox[{
            RowBox[{"areas", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"heights", "[", 
               RowBox[{"[", 
                RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", 
              RowBox[{"heights", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}]}], ",", 
          RowBox[{
           RowBox[{"RectBottom", "[", "parent", "]"}], "+", 
           RowBox[{"heights", "[", 
            RowBox[{"[", 
             RowBox[{"i", "+", "1"}], "]"}], "]"}]}]}], "}"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{
         RowBox[{"Length", "[", "heights", "]"}], "-", "1"}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.602371244178576*^9, 3.602371278389196*^9}, {
   3.602371312988514*^9, 3.602371319864633*^9}, {3.6023713692185287`*^9, 
   3.6023714493535557`*^9}, {3.602371555249505*^9, 3.602371624930914*^9}, {
   3.60237166906798*^9, 3.6023717523886833`*^9}, {3.6023719593417397`*^9, 
   3.602371998377706*^9}, {3.602372081423913*^9, 3.6023721134814777`*^9}, {
   3.602372501760611*^9, 3.6023725023189983`*^9}, {3.602372578991544*^9, 
   3.6023726216873493`*^9}, {3.6023726994814377`*^9, 3.60237279031316*^9}, {
   3.602372866985978*^9, 3.602372871539558*^9}, {3.602373086414599*^9, 
   3.60237311162733*^9}, {3.602373145126645*^9, 3.602373214427053*^9}, {
   3.602373409491143*^9, 3.602373410212173*^9}, {3.602373442769988*^9, 
   3.6023734497252607`*^9}, {3.602373538526919*^9, 3.602373586130636*^9}, {
   3.602373654271184*^9, 3.602373684658854*^9}, {3.6023737261136293`*^9, 
   3.602373735570578*^9}, {3.602373768102347*^9, 3.6023737681630297`*^9}, {
   3.602374597458872*^9, 3.602374610053255*^9}, {3.602374820065361*^9, 
   3.6023748430424128`*^9}, {3.602374904719187*^9, 3.60237490538655*^9}, {
   3.602374935433037*^9, 3.602374971432311*^9}, {3.602375010742491*^9, 
   3.60237501700489*^9}, {3.602443059511222*^9, 3.602443069971537*^9}, {
   3.6024431141062717`*^9, 3.602443176669511*^9}, {3.602443210319322*^9, 
   3.602443230564576*^9}, {3.602443267070924*^9, 3.602443316092388*^9}, 
   3.602443370343116*^9, {3.602443652670582*^9, 3.60244366156221*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FillRectangle", "[", 
   RowBox[{"parent_Rectangle", ",", 
    RowBox[{"{", "}"}], ",", "Horizontal"}], "]"}], ":=", 
  RowBox[{"{", "}"}]}]], "Input",
 CellChangeTimes->{{3.6023723481258287`*^9, 3.602372362021021*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FillRectangle", "[", 
   RowBox[{"parent_Rectangle", ",", "areas_List", ",", "Horizontal"}], "]"}], 
  ":=", "\[IndentingNewLine]", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"widths", "=", 
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Width", "[", "parent", "]"}], "*", 
         RowBox[{
          RowBox[{"Accumulate", "[", "areas", "]"}], "/", 
          RowBox[{"Total", "[", "areas", "]"}]}]}], ",", "0"}], "]"}]}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Rectangle", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"RectLeft", "[", "parent", "]"}], "+", 
           RowBox[{"widths", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"RectBottom", "[", "parent", "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"RectLeft", "[", "parent", "]"}], "+", 
           RowBox[{"widths", "[", 
            RowBox[{"[", 
             RowBox[{"i", "+", "1"}], "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"RectBottom", "[", "parent", "]"}], "+", 
           RowBox[{
            RowBox[{"areas", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"widths", "[", 
               RowBox[{"[", 
                RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", 
              RowBox[{"widths", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}]}]}], "}"}]}], "]"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{
         RowBox[{"Length", "[", "widths", "]"}], "-", "1"}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.602372364400833*^9, 3.602372394014242*^9}, {
  3.602373961202754*^9, 3.60237403933397*^9}, {3.602374080164459*^9, 
  3.602374121812087*^9}, {3.602374270008233*^9, 3.602374271153124*^9}, {
  3.602374368479094*^9, 3.602374369927043*^9}, {3.60237463429427*^9, 
  3.602374689934432*^9}, {3.6023747327692347`*^9, 3.602374742433421*^9}, {
  3.60237481070996*^9, 3.602374813396277*^9}, {3.602443857364462*^9, 
  3.6024439628361692`*^9}}],

Cell[CellGroupData[{

Cell["Test Fill", "Subsection",
 CellChangeTimes->{{3.6023718668850327`*^9, 3.6023718757024193`*^9}, {
  3.602372158690303*^9, 3.602372163615999*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FillRectangle", "[", 
  RowBox[{
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "4"}], "}"}]}], "]"}], ",", 
   RowBox[{"{", "6", "}"}], ",", "Vertical"}], "]"}]], "Input",
 CellChangeTimes->{{3.602371854361652*^9, 3.602371909677833*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"Rectangle", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      FractionBox["3", "2"], ",", "4"}], "}"}]}], "]"}], "}"}]], "Output",
 CellChangeTimes->{
  3.602371910693713*^9, {3.6023719806181583`*^9, 3.602372001941762*^9}, {
   3.602372116623108*^9, 3.6023721340702343`*^9}, 3.602373333037876*^9, 
   3.602373414671294*^9, 3.6023735902774353`*^9, {3.602373743853569*^9, 
   3.6023737729807253`*^9}, 3.6023746184576397`*^9, 3.6023746953337708`*^9, 
   3.602374744952785*^9, {3.602374832801587*^9, 3.602374847198935*^9}, 
   3.602375020539915*^9, 3.60244332209515*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FillRectangle", "[", 
  RowBox[{
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "4"}], "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "6"}], "}"}], ",", "Vertical"}], "]"}]], "Input",
 CellChangeTimes->{{3.602371854361652*^9, 3.602371909677833*^9}, {
  3.602375048888534*^9, 3.60237504899582*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "2"}], "}"}]}], "]"}], ",", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6023750495397387`*^9, 3.6024433243359632`*^9, 
  3.602443481580501*^9, 3.602443667769269*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FillRectangle", "[", 
  RowBox[{
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "4"}], "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "6", ",", "4"}], "}"}], ",", "Vertical"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6024436928677464`*^9, 3.60244370998629*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", 
       FractionBox["3", "2"]}], "}"}]}], "]"}], ",", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       FractionBox["3", "2"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "3"}], "}"}]}], "]"}], ",", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "4"}], "}"}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.602443710955226*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FillRectangle", "[", 
  RowBox[{
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"3", "/", "2"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "4"}], "}"}]}], "]"}], ",", 
   RowBox[{"{", "4", "}"}], ",", "Horizontal"}], "]"}]], "Input",
 CellChangeTimes->{{3.602374128321138*^9, 3.60237417637915*^9}, {
  3.602374358882823*^9, 3.602374359010396*^9}, {3.602443985191996*^9, 
  3.602444003986719*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"Rectangle", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      FractionBox["3", "2"], ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"6", ",", 
      FractionBox["8", "9"]}], "}"}]}], "]"}], "}"}]], "Output",
 CellChangeTimes->{{3.602374359648638*^9, 3.602374373632557*^9}, 
   3.602444004527836*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FillRectangle", "[", 
  RowBox[{
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "4"}], "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "3"}], "}"}], ",", "Horizontal"}], "]"}]], "Input",
 CellChangeTimes->{{3.602374128321138*^9, 3.60237417637915*^9}, {
  3.60244404962921*^9, 3.602444059291832*^9}, {3.602444848254836*^9, 
  3.6024448484516983`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       FractionBox["33", "7"], ",", 
       FractionBox["7", "3"]}], "}"}]}], "]"}], ",", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       FractionBox["33", "7"], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", 
       FractionBox["7", "3"]}], "}"}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.602444216451622*^9, 3.602444221010242*^9}, 
   3.602444263688156*^9, 3.602444849079303*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Visualize Iterative Rectangles", "Section",
 CellChangeTimes->{{3.602444225570979*^9, 3.6024442379796963`*^9}}],

Cell["\<\
Given a list of rectangles, create a graphic.\
\>", "Text",
 CellChangeTimes->{{3.60244424301528*^9, 3.602444284222712*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"VizRectangles", "[", "rectangles_List", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Join", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EdgeForm", "[", 
         RowBox[{"{", 
          RowBox[{"Thick", ",", "Black"}], "}"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Opacity", "[", 
         RowBox[{"7", "/", "10"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Riffle", "[", 
       RowBox[{"rectangles", ",", 
        RowBox[{"ColorData", "[", 
         RowBox[{"\"\<Crayola\>\"", ",", "\"\<ColorList\>\""}], "]"}]}], 
       "]"}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Axes", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
    RowBox[{"GridLines", "\[Rule]", "Automatic"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.602444289531323*^9, 3.602444315798099*^9}, {
  3.6024443578220797`*^9, 3.602444363672782*^9}, {3.6024444552703037`*^9, 
  3.602444480094268*^9}, {3.602444552943162*^9, 3.602444605000649*^9}, {
  3.602445405889428*^9, 3.602445433850831*^9}, {3.602445465097137*^9, 
  3.60244547397862*^9}, {3.602445654231288*^9, 3.602445661034292*^9}, {
  3.6024457029907417`*^9, 3.602445714382008*^9}, {3.60244575521938*^9, 
  3.602445755315938*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"VizRectangles", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Rectangle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"6", ",", "4"}], "}"}]}], "]"}], ",", 
    RowBox[{"Rectangle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "2"}], "}"}]}], "]"}], ",", 
    RowBox[{"Rectangle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "4"}], "}"}]}], "]"}], ",", 
    RowBox[{"Rectangle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"3", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        FractionBox["33", "7"], ",", 
        FractionBox["7", "3"]}], "}"}]}], "]"}], ",", 
    RowBox[{"Rectangle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        FractionBox["33", "7"], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"6", ",", 
        FractionBox["7", "3"]}], "}"}]}], "]"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.6024443173739433`*^9, 3.602444345741281*^9}, {
   3.602444495329114*^9, 3.602444512448501*^9}, {3.602444791229497*^9, 
   3.602444814211228*^9}, 3.602444864100039*^9}],

Cell[BoxData[
 GraphicsBox[
  {Opacity[
    NCache[
     Rational[7, 10], 0.7]], EdgeForm[{GrayLevel[0], Thickness[Large]}], 
   RectangleBox[{0, 0}, {6, 4}], 
   {RGBColor[0.9372549019607843, 0.8705882352941177, 0.803921568627451], 
    RectangleBox[{0, 0}, {3, 2}]}, 
   {RGBColor[0.803921568627451, 0.5843137254901961, 0.4588235294117647], 
    RectangleBox[{0, 2}, {3, 4}]}, 
   {RGBColor[0.9921568627450981, 0.8509803921568627, 0.7098039215686275], 
    RectangleBox[{3, 0}, 
     NCache[{Rational[33, 7], Rational[7, 3]}, {4.714285714285714, 
      2.3333333333333335`}]]}, 
   {RGBColor[0.47058823529411764`, 0.8588235294117647, 0.8862745098039215], 
    RectangleBox[NCache[{Rational[33, 7], 0}, {4.714285714285714, 0}], 
     NCache[{6, Rational[7, 3]}, {6, 2.3333333333333335`}]]}},
  Axes->True,
  GridLines->Automatic]], "Output",
 CellChangeTimes->{
  3.6024448147967*^9, 3.602444864616403*^9, {3.602445669045532*^9, 
   3.602445675134718*^9}, {3.602445711413278*^9, 3.602445716695229*^9}, 
   3.602445757894126*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Squarified Treemap Algorithm", "Section",
 CellChangeTimes->{{3.602109288834806*^9, 3.6021092939876432`*^9}}],

Cell["\<\
As a heuristic, the squarified treemap algorithm adds child rectangles to the \
parent (within a given orientation, either Vertical or Horizontal) until the \
maximum aspect ratio of the children is greater than current step.\
\>", "Text",
 CellChangeTimes->{{3.602463279534951*^9, 3.602463364633317*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"WorstAspectRatio", "[", "rectangles_", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Max", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"RectAspectRatio", "[", "#", "]"}], "&"}], "/@", "rectangles"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.60246340641988*^9, 3.602463431745137*^9}, {
  3.6024635154014053`*^9, 3.602463516023727*^9}}],

Cell[CellGroupData[{

Cell["Test WorstAspectRatio", "Subsection",
 CellChangeTimes->{{3.6024634620594378`*^9, 3.602463465618157*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"WorstAspectRatio", "[", 
  RowBox[{"{", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"3", "/", "2"}], ",", "4"}], "}"}]}], "]"}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.602463469344775*^9, 3.60246349713678*^9}}],

Cell[BoxData[
 FractionBox["8", "3"]], "Output",
 CellChangeTimes->{{3.602463497728829*^9, 3.602463519797203*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"WorstAspectRatio", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Rectangle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "2"}], "}"}]}], "]"}], ",", 
    RowBox[{"Rectangle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "4"}], "}"}]}], "]"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.60246352331207*^9, 3.602463558523307*^9}}],

Cell[BoxData[
 FractionBox["3", "2"]], "Output",
 CellChangeTimes->{3.602463559323513*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"WorstAspectRatio", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Rectangle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", 
        FractionBox["3", "2"]}], "}"}]}], "]"}], ",", 
    RowBox[{"Rectangle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", 
        FractionBox["3", "2"]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "3"}], "}"}]}], "]"}], ",", 
    RowBox[{"Rectangle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "4"}], "}"}]}], "]"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.602463561537929*^9, 3.6024636030275297`*^9}}],

Cell[BoxData["4"], "Output",
 CellChangeTimes->{3.602463603611397*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Placing till a Local Minima", "Subsection",
 CellChangeTimes->{{3.60246399907143*^9, 3.602464003312495*^9}}],

Cell[TextData[{
 "As previously stated, the algorithm works by iteratively placing rectangles \
until a local minima of WorstAspectRatio is met. The function ",
 StyleBox["PlaceTillLocalMinima",
  FontSlant->"Italic"],
 " returns a list of rectangles placed into a given parent rectangle with a \
list (pre-sorted in descending order) of areas."
}], "Text",
 CellChangeTimes->{{3.602464008082123*^9, 3.602464106609935*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PlaceTillLocalMinima", "[", 
   RowBox[{"parent_Rectangle", ",", "areas_List", ",", "orientation_"}], 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"PlaceTillLocalMinima", "[", 
   RowBox[{
   "parent", ",", "areas", ",", "orientation", ",", "\[Infinity]", ",", "0"}],
    "]"}]}]], "Input",
 CellChangeTimes->{{3.602464110144699*^9, 3.6024641503743563`*^9}, {
  3.602464210494038*^9, 3.602464211049687*^9}, {3.6024643619172297`*^9, 
  3.60246436963927*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PlaceTillLocalMinima", "[", 
   RowBox[{
   "parent_Rectangle", ",", "areas_List", ",", "orientation_", ",", 
    "previousRatio_", ",", "prevTake_"}], "]"}], ":=", "\[IndentingNewLine]", 
  
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"prevTake", "+", "1"}], "<=", 
     RowBox[{"Length", "[", "areas", "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"take", "=", 
        RowBox[{"FillRectangle", "[", 
         RowBox[{"parent", ",", 
          RowBox[{"Take", "[", 
           RowBox[{"areas", ",", 
            RowBox[{"prevTake", "+", "1"}]}], "]"}], ",", "orientation"}], 
         "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"WorstAspectRatio", "[", "take", "]"}], "<", 
         "previousRatio"}], ",", "\[IndentingNewLine]", 
        RowBox[{"PlaceTillLocalMinima", "[", 
         RowBox[{"parent", ",", "areas", ",", "orientation", ",", 
          RowBox[{"WorstAspectRatio", "[", "take", "]"}], ",", 
          RowBox[{"prevTake", "+", "1"}]}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"FillRectangle", "[", 
         RowBox[{"parent", ",", 
          RowBox[{"Take", "[", 
           RowBox[{"areas", ",", "prevTake"}], "]"}], ",", "orientation"}], 
         "]"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
     "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"FillRectangle", "[", 
     RowBox[{"parent", ",", "areas", ",", "orientation"}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.602464153683032*^9, 3.6024641761259327`*^9}, {
  3.602464213643487*^9, 3.602464535643433*^9}, {3.6024647524574747`*^9, 
  3.6024647586761227`*^9}, {3.602464870681897*^9, 3.6024649062050047`*^9}}],

Cell[CellGroupData[{

Cell["\<\
Test Placing till a Local Minima\
\>", "Subsubsection",
 CellChangeTimes->{{3.602464548602089*^9, 3.602464553475585*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PlaceTillLocalMinima", "[", 
  RowBox[{
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "4"}], "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "6", ",", "4", ",", "3", ",", "2", ",", "2", ",", "1"}],
     "}"}], ",", "Vertical"}], "]"}]], "Input",
 CellChangeTimes->{{3.602464559100952*^9, 3.602464601556774*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "2"}], "}"}]}], "]"}], ",", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.60246460257121*^9, 3.6024646716385813`*^9, 
  3.602464768287414*^9, 3.602464873847897*^9, 3.602464912314728*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PlaceTillLocalMinima", "[", 
  RowBox[{
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "4"}], "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "3", ",", "2", ",", "1", ",", "1"}], "}"}], ",", 
   "Horizontal"}], "]"}]], "Input",
 CellChangeTimes->{{3.6024649260007553`*^9, 3.602464975992446*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       FractionBox["33", "7"], ",", 
       FractionBox["7", "3"]}], "}"}]}], "]"}], ",", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       FractionBox["33", "7"], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", 
       FractionBox["7", "3"]}], "}"}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.602464977136277*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Finding Remainder", "Subsection",
 CellChangeTimes->{{3.602508317075494*^9, 3.602508319870194*^9}}],

Cell["\<\
Once a set of sub-rectangles has been added to a parent, the next step will \
be to calculate the remaining portion of the parent. This function takes \
advantage of the fact that the children will be a subset of the parent -- no \
overlap and the children will themselves form a rectangle.\
\>", "Text",
 CellChangeTimes->{{3.6025083290443068`*^9, 3.602508431307529*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"EnclosingRectangle", "[", "rectangles_", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Rectangle", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Min", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"RectLeft", "[", "#", "]"}], "&"}], "/@", "rectangles"}], 
       "]"}], ",", 
      RowBox[{"Min", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"RectBottom", "[", "#", "]"}], "&"}], "/@", "rectangles"}], 
       "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Max", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"RectRight", "[", "#", "]"}], "&"}], "/@", "rectangles"}], 
       "]"}], ",", 
      RowBox[{"Max", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"RectTop", "[", "#", "]"}], "&"}], "/@", "rectangles"}], 
       "]"}]}], "}"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6025084426804132`*^9, 3.602508541518449*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RemainingRectangle", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Rectangle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pxmin_", ",", "pymin_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"pxmax_", ",", "pymax_"}], "}"}]}], "]"}], ",", 
    RowBox[{"Rectangle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"cxmin_", ",", "cymin_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"cxmax_", ",", "cymax_"}], "}"}]}], "]"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Switch", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"pxmin", "\[Equal]", "cxmin"}], "\[And]", 
       RowBox[{"pxmax", "\[Equal]", "cxmax"}]}], ",", 
      RowBox[{
       RowBox[{"pymin", "\[Equal]", "cymin"}], "\[And]", 
       RowBox[{"pymax", "\[Equal]", "cymax"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"False", ",", "False"}], "}"}], " ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "child", " ", "NOT", " ", "a", " ", "subset", " ", "of", " ", "parent"}],
      " ", "*)"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Abort", "[", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"False", ",", "True"}], "}"}], 
    RowBox[{"(*", " ", 
     RowBox[{"remainder", " ", "on", " ", "right"}], " ", "*)"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Rectangle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"cxmax", ",", "pymin"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"pxmax", ",", "pymax"}], "}"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"True", ",", "False"}], "}"}], 
    RowBox[{"(*", " ", 
     RowBox[{"remainder", " ", "on", " ", "top"}], " ", "*)"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Rectangle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pxmin", ",", "cymax"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"pxmax", ",", "pymax"}], "}"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"True", ",", "True"}], "}"}], 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"child", " ", "\[Equal]", " ", "parent"}], ",", " ", 
      RowBox[{"no", " ", "remainder"}]}], " ", "*)"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Rectangle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pxmax", ",", "pymax"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"pxmax", ",", "pymax"}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.60250862892605*^9, 3.602508647560165*^9}, {
  3.602508679036374*^9, 3.6025086890878963`*^9}, {3.602508844906156*^9, 
  3.602508915783186*^9}, {3.602508990819689*^9, 3.602509064526497*^9}, {
  3.602509136184848*^9, 3.602509170964827*^9}, {3.602509255096982*^9, 
  3.602509279054606*^9}, {3.602509358352906*^9, 3.602509526971867*^9}}],

Cell[CellGroupData[{

Cell["Test Finding Remainder", "Subsubsection",
 CellChangeTimes->{{3.602508550293008*^9, 3.6025085541009293`*^9}, {
  3.6025085937823772`*^9, 3.60250859878374*^9}, {3.602508656543277*^9, 
  3.602508658717112*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EnclosingRectangle", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Rectangle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "2"}], "}"}]}], "]"}], ",", 
    RowBox[{"Rectangle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "4"}], "}"}]}], "]"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.602508564206484*^9, 3.602508580703615*^9}}],

Cell[BoxData[
 RowBox[{"Rectangle", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4"}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{3.60250858122738*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RemainingRectangle", "[", 
  RowBox[{
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "4"}], "}"}]}], "]"}], ",", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6025095349528103`*^9, 3.6025095709879093`*^9}}],

Cell[BoxData[
 RowBox[{"Rectangle", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"3", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "4"}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{3.60250957166665*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RemainingRectangle", "[", 
  RowBox[{
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "4"}], "}"}]}], "]"}], ",", 
   RowBox[{"EnclosingRectangle", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Rectangle", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"3", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          FractionBox["33", "7"], ",", 
          FractionBox["7", "3"]}], "}"}]}], "]"}], ",", 
      RowBox[{"Rectangle", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          FractionBox["33", "7"], ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"6", ",", 
          FractionBox["7", "3"]}], "}"}]}], "]"}]}], "}"}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.602509594629032*^9, 3.602509607460833*^9}, {
  3.602509650364799*^9, 3.6025096535873938`*^9}}],

Cell[BoxData[
 RowBox[{"Rectangle", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"3", ",", 
     FractionBox["7", "3"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "4"}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{3.602509654287003*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RemainingRectangle", "[", 
  RowBox[{
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], "]"}], ",", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.602509673908774*^9, 3.6025096981155024`*^9}}],

Cell[BoxData[
 RowBox[{"Rectangle", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{3.60250969887912*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Squarify", "Section",
 CellChangeTimes->{{3.602509757395031*^9, 3.6025097583595657`*^9}}],

Cell["\<\
With all the pieces together, we can now write the Squarify function. This \
function takes the definition of a parent rectangle and a list of areas \
(whose sum must equal the area of the parent) and returns a list of \
Rectangles.\
\>", "Text",
 CellChangeTimes->{{3.602509762415707*^9, 3.6025098548871813`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Squarify", "[", 
   RowBox[{"parent_Rectangle", ",", "areas_List"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Squarify", "[", 
   RowBox[{"parent", ",", "areas", ",", 
    RowBox[{"{", "}"}], ",", "Vertical"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.602509860606448*^9, 3.602509908622924*^9}, {
  3.6025099975565033`*^9, 3.602509998652751*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Squarify", "[", 
   RowBox[{
   "parent_Rectangle", ",", "areas_List", ",", "placed_List", ",", 
    "orientation_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "areas", "]"}], "\[Equal]", "0"}], ",", "placed", 
    ",", "\[IndentingNewLine]", 
    RowBox[{"Block", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"placeThisStep", "=", 
        RowBox[{"PlaceTillLocalMinima", "[", 
         RowBox[{"parent", ",", "areas", ",", "orientation"}], "]"}]}], "}"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{"Squarify", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"RemainingRectangle", "[", 
         RowBox[{"parent", ",", 
          RowBox[{"EnclosingRectangle", "[", "placeThisStep", "]"}]}], "]"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"Drop", "[", 
         RowBox[{"areas", ",", 
          RowBox[{"Length", "[", "placeThisStep", "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Join", "[", 
         RowBox[{"placed", ",", "placeThisStep"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"InvertOrientation", "[", "orientation", "]"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6025099139776373`*^9, 3.60250993622832*^9}, {
  3.6025099747557898`*^9, 3.602510082878002*^9}, {3.6025101338650618`*^9, 
  3.6025102207219276`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Squarify", "[", 
  RowBox[{
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "4"}], "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "6", ",", "4", ",", "3", ",", "2", ",", "2", ",", "1"}],
     "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.602510299069998*^9, 3.602510327183928*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "2"}], "}"}]}], "]"}], ",", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}]}], "]"}], ",", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       FractionBox["33", "7"], ",", 
       FractionBox["7", "3"]}], "}"}]}], "]"}], ",", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       FractionBox["33", "7"], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", 
       FractionBox["7", "3"]}], "}"}]}], "]"}], ",", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", 
       FractionBox["7", "3"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       FractionBox["21", "5"], ",", "4"}], "}"}]}], "]"}], ",", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       FractionBox["21", "5"], ",", 
       FractionBox["7", "3"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", 
       FractionBox["31", "9"]}], "}"}]}], "]"}], ",", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       FractionBox["21", "5"], ",", 
       FractionBox["31", "9"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "4"}], "}"}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.60251032915232*^9, 3.602510361464468*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"VizRectangles", "[", "%47", "]"}]], "Input",
 CellChangeTimes->{{3.6025103684462957`*^9, 3.602510375775859*^9}}],

Cell[BoxData[
 GraphicsBox[
  {Opacity[
    NCache[
     Rational[7, 10], 0.7]], EdgeForm[{GrayLevel[0], Thickness[Large]}], 
   RectangleBox[{0, 0}, {3, 2}], 
   {RGBColor[0.9372549019607843, 0.8705882352941177, 0.803921568627451], 
    RectangleBox[{0, 2}, {3, 4}]}, 
   {RGBColor[0.803921568627451, 0.5843137254901961, 0.4588235294117647], 
    RectangleBox[{3, 0}, 
     NCache[{Rational[33, 7], Rational[7, 3]}, {4.714285714285714, 
      2.3333333333333335`}]]}, 
   {RGBColor[0.9921568627450981, 0.8509803921568627, 0.7098039215686275], 
    RectangleBox[NCache[{Rational[33, 7], 0}, {4.714285714285714, 0}], 
     NCache[{6, Rational[7, 3]}, {6, 2.3333333333333335`}]]}, 
   {RGBColor[0.47058823529411764`, 0.8588235294117647, 0.8862745098039215], 
    RectangleBox[NCache[{3, Rational[7, 3]}, {3, 2.3333333333333335`}], 
     NCache[{Rational[21, 5], 4}, {4.2, 4}]]}, 
   {RGBColor[0.5294117647058824, 0.6627450980392157, 0.4196078431372549], 
    RectangleBox[
     NCache[{Rational[21, 5], Rational[7, 3]}, {4.2, 2.3333333333333335`}], 
     NCache[{6, Rational[31, 9]}, {6, 3.4444444444444446`}]]}, 
   {RGBColor[1., 0.6431372549019608, 0.4549019607843137], 
    RectangleBox[
     NCache[{Rational[21, 5], Rational[31, 9]}, {4.2, 
      3.4444444444444446`}], {6, 4}]}},
  Axes->True,
  GridLines->Automatic]], "Output",
 CellChangeTimes->{3.602510376276499*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{740, 867},
WindowMargins->{{510, Automatic}, {Automatic, 51}},
FrontEndVersion->"9.0 for Linux x86 (64-bit) (February 7, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 90, 1, 93, "Title"],
Cell[672, 25, 114, 1, 51, "Subtitle"],
Cell[CellGroupData[{
Cell[811, 30, 97, 1, 81, "Section"],
Cell[911, 33, 313, 6, 51, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1261, 44, 89, 1, 81, "Section"],
Cell[1353, 47, 393, 6, 71, "Text"],
Cell[1749, 55, 286, 5, 71, "Text"],
Cell[2038, 62, 582, 15, 55, "Input"],
Cell[2623, 79, 162, 3, 31, "Text"],
Cell[2788, 84, 441, 9, 71, "Text"],
Cell[3232, 95, 394, 9, 55, "Input"],
Cell[3629, 106, 1607, 39, 209, "Input"],
Cell[CellGroupData[{
Cell[5261, 149, 152, 2, 32, "Input"],
Cell[5416, 153, 986, 27, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6439, 185, 178, 3, 32, "Input"],
Cell[6620, 190, 17030, 482, 327, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[23699, 678, 106, 1, 81, "Section"],
Cell[23808, 681, 326, 8, 32, "Input"],
Cell[24137, 691, 530, 13, 55, "Input"],
Cell[CellGroupData[{
Cell[24692, 708, 243, 5, 32, "Input"],
Cell[24938, 715, 223, 3, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25198, 723, 97, 1, 45, "Subsection"],
Cell[25298, 726, 662, 22, 51, "Text"],
Cell[25963, 750, 392, 11, 55, "Input"],
Cell[26358, 763, 393, 11, 55, "Input"],
Cell[26754, 776, 379, 8, 55, "Input"],
Cell[27136, 786, 343, 10, 32, "Input"],
Cell[27482, 798, 342, 10, 55, "Input"],
Cell[27827, 810, 342, 10, 32, "Input"],
Cell[28172, 822, 347, 10, 55, "Input"],
Cell[CellGroupData[{
Cell[28544, 836, 286, 8, 32, "Input"],
Cell[28833, 846, 95, 1, 32, "Output"]
}, Open  ]],
Cell[28943, 850, 244, 5, 51, "Text"],
Cell[29190, 857, 937, 25, 143, "Input"],
Cell[CellGroupData[{
Cell[30152, 886, 325, 9, 32, "Input"],
Cell[30480, 897, 90, 2, 49, "Output"]
}, Open  ]],
Cell[30585, 902, 204, 4, 51, "Text"],
Cell[30792, 908, 181, 4, 32, "Input"],
Cell[30976, 914, 181, 4, 32, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[31206, 924, 109, 1, 81, "Section"],
Cell[31318, 927, 238, 4, 51, "Text"],
Cell[31559, 933, 264, 5, 51, "Text"],
Cell[31826, 940, 303, 7, 32, "Input"],
Cell[32132, 949, 3450, 73, 297, "Input"],
Cell[35585, 1024, 254, 6, 32, "Input"],
Cell[35842, 1032, 2447, 60, 319, "Input"],
Cell[CellGroupData[{
Cell[38314, 1096, 150, 2, 45, "Subsection"],
Cell[CellGroupData[{
Cell[38489, 1102, 364, 10, 32, "Input"],
Cell[38856, 1114, 673, 15, 49, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39566, 1134, 437, 12, 32, "Input"],
Cell[40006, 1148, 524, 16, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40567, 1169, 403, 12, 32, "Input"],
Cell[40973, 1183, 681, 23, 89, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41691, 1211, 491, 13, 32, "Input"],
Cell[42185, 1226, 354, 11, 49, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42576, 1242, 489, 13, 32, "Input"],
Cell[43068, 1257, 629, 20, 49, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[43758, 1284, 117, 1, 81, "Section"],
Cell[43878, 1287, 134, 3, 31, "Text"],
Cell[44015, 1292, 1415, 30, 231, "Input"],
Cell[CellGroupData[{
Cell[45455, 1326, 1313, 40, 138, "Input"],
Cell[46771, 1368, 1029, 22, 267, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[47849, 1396, 115, 1, 81, "Section"],
Cell[47967, 1399, 315, 5, 71, "Text"],
Cell[48285, 1406, 378, 10, 55, "Input"],
Cell[CellGroupData[{
Cell[48688, 1420, 111, 1, 45, "Subsection"],
Cell[CellGroupData[{
Cell[48824, 1425, 356, 11, 32, "Input"],
Cell[49183, 1438, 114, 2, 49, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49334, 1445, 529, 16, 55, "Input"],
Cell[49866, 1463, 90, 2, 49, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49993, 1470, 770, 24, 105, "Input"],
Cell[50766, 1496, 70, 1, 32, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[50885, 1503, 114, 1, 45, "Subsection"],
Cell[51002, 1506, 423, 8, 91, "Text"],
Cell[51428, 1516, 498, 11, 77, "Input"],
Cell[51929, 1529, 1849, 42, 319, "Input"],
Cell[CellGroupData[{
Cell[53803, 1575, 131, 3, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[53959, 1582, 451, 12, 55, "Input"],
Cell[54413, 1596, 543, 16, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[54993, 1617, 434, 12, 55, "Input"],
Cell[55430, 1631, 557, 19, 49, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[56048, 1657, 105, 1, 45, "Subsection"],
Cell[56156, 1660, 382, 6, 91, "Text"],
Cell[56541, 1668, 1016, 30, 165, "Input"],
Cell[57560, 1700, 2904, 77, 319, "Input"],
Cell[CellGroupData[{
Cell[60489, 1781, 214, 3, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[60728, 1788, 532, 16, 55, "Input"],
Cell[61263, 1806, 225, 7, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[61525, 1818, 500, 15, 55, "Input"],
Cell[62028, 1835, 225, 7, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[62290, 1847, 969, 30, 138, "Input"],
Cell[63262, 1879, 250, 8, 49, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[63549, 1892, 498, 15, 55, "Input"],
Cell[64050, 1909, 225, 7, 32, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[64348, 1924, 95, 1, 81, "Section"],
Cell[64446, 1927, 324, 6, 71, "Text"],
Cell[64773, 1935, 391, 9, 55, "Input"],
Cell[65167, 1946, 1543, 36, 341, "Input"],
Cell[CellGroupData[{
Cell[66735, 1986, 422, 12, 32, "Input"],
Cell[67160, 2000, 1655, 56, 162, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[68852, 2061, 136, 2, 32, "Input"],
Cell[68991, 2065, 1375, 28, 300, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
