(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    110700,       3255]
NotebookOptionsPosition[    101883,       2959]
NotebookOutlinePosition[    102812,       2994]
CellTagsIndexPosition[    102667,       2987]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Squarified Treemap", "Title",
 CellChangeTimes->{{3.60251229732694*^9, 3.602512300087603*^9}}],

Cell[TextData[{
 "A Functional Implementation in ",
 StyleBox["Mathematica",
  FontSlant->"Italic"]
}], "Subtitle",
 CellChangeTimes->{{3.6025123213022327`*^9, 3.602512336719819*^9}}],

Cell["By Jeffrey Starr, 2014-02", "Subsubtitle",
 CellChangeTimes->{{3.6025123424867687`*^9, 3.602512366358447*^9}}],

Cell[CellGroupData[{

Cell["Abstract", "Section",
 CellChangeTimes->{{3.602512406917881*^9, 3.602512409112266*^9}}],

Cell[TextData[{
 "This paper presents an implementation of the Squarified Treemap algorithm \
(originally published by Bruls, Huizing, and van Wijk)",
 ButtonBox[Cell[TextData[StyleBox[ButtonBox["1"],
  FontVariations->{"CompatibilityType"->"Superscript"}]], "Citation",
  Editable->False,
  TaggingRules->{NoteData -> RowBox[{
       RowBox[{"M", ".", " ", "Bruls"}], ",", " ", 
       RowBox[{"K", ".", " ", "Huizing"}], ",", " ", 
       RowBox[{"and", " ", 
         RowBox[{"J", ".", " ", "van"}], " ", "Wijk"}], ",", " ", 
       RowBox[{
        "\"Squarified treemaps,\"", " ", "in", " ", "Proceedings", " ", "of", 
         " ", "the", " ", "Joint", " ", "Eurographics", " ", "and", " ", 
         "IEEE", " ", "TCVG", " ", "Symposium", " ", "on", " ", 
         "Visualization"}], ",", " ", 
       RowBox[{
         RowBox[{"pp", ".", " ", "33"}], "-", "42"}], ",", " ", "2000.", 
       " "}]}],
  BaseStyle->"Hyperlink",
  ButtonData->"00007748"],
 " for multiple-levels of hierarchy written in a functional style using the \
",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " language."
}], "Text",
 CellChangeTimes->{{3.6025125470626707`*^9, 3.6025125808567944`*^9}, {
  3.602512802489868*^9, 3.6025128025370903`*^9}, {3.60251284608927*^9, 
  3.602512898216193*^9}, {3.602513643116025*^9, 3.602513643130681*^9}, {
  3.602700247713298*^9, 3.6027002583390427`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Introduction", "Section",
 CellChangeTimes->{{3.6025124124305143`*^9, 3.602512413744054*^9}}],

Cell[TextData[{
 "A treemap is a popular visualization technique because of its density (high \
data content per square inch) and ability to handle hierarchical data. \
Treemaps visualize quantities by creating rectangles with areas that match \
(proportionally, at least) the original quantities. Viewers compare values by \
comparing areas. By using rectangles, treemaps are more dense than pie charts \
and there is evidence humans can compare areas of rectangles more accurately \
than wedges of a circle. Treemaps can also connote hierarchy by embedding \
rectangles in other rectangles recursively. This technique is often used to \
help viewers find files consuming excessive disk space by plotting the file \
size as the area of the rectangle and embedding the file rectangles within \
other rectangles to show the directory structure.",
 ButtonBox[Cell[TextData[StyleBox[ButtonBox["2"],
  FontVariations->{"CompatibilityType"->"Superscript"}]], "Citation",
  Editable->False,
  TaggingRules->{NoteData -> RowBox[{
       RowBox[{"http", ":"}], "//", 
       RowBox[{
         RowBox[{
           RowBox[{"en", ".", "wikipedia", ".", "org"}], "/", "wiki"}], "/", 
         RowBox[{"File", ":", 
           RowBox[{"Tree_Map", ".", "png"}]}]}]}]}],
  BaseStyle->"Hyperlink",
  ButtonData->"000035FD"]
}], "Text",
 CellChangeTimes->{{3.602512986095559*^9, 3.6025130406678047`*^9}, {
  3.602513145579069*^9, 3.60251317483816*^9}, {3.602513217901408*^9, 
  3.602513547911072*^9}, {3.602513643093647*^9, 3.602513643169352*^9}, {
  3.602528042350157*^9, 3.602528044870391*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Rectangle, the Core Data Structure\
\>", "Section",
 CellChangeTimes->{{3.6025124217268248`*^9, 3.6025124265904093`*^9}}],

Cell["\<\
The Squarified Treemap algorithm draws rectangles in other rectangles. Not \
all treemap algorithms use rectangles, but rectangles are the most popular \
choice.\
\>", "Text",
 CellChangeTimes->{{3.60251390688922*^9, 3.602513971931239*^9}}],

Cell[TextData[{
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " provides an existing data structure for a Rectangle which we will use \
within this paper."
}], "Text",
 CellChangeTimes->{{3.602513982994248*^9, 3.602514013142123*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "Rectangle"}]], "Input",
 CellChangeTimes->{{3.602513988328244*^9, 3.602513989804492*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox["\<\"\!\(\*RowBox[{\\\"Rectangle\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{SubscriptBox[StyleBox[\\\"x\\\", \
\\\"TI\\\"], StyleBox[\\\"min\\\", \\\"TI\\\"]], \\\",\\\", \
SubscriptBox[StyleBox[\\\"y\\\", \\\"TI\\\"], StyleBox[\\\"min\\\", \
\\\"TI\\\"]]}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{SubscriptBox[StyleBox[\\\"x\\\", \\\"TI\\\"], StyleBox[\\\"max\\\", \
\\\"TI\\\"]], \\\",\\\", SubscriptBox[StyleBox[\\\"y\\\", \\\"TI\\\"], \
StyleBox[\\\"max\\\", \\\"TI\\\"]]}], \\\"}\\\"}]}], \\\"]\\\"}]\) is a \
two-dimensional graphics primitive that represents a filled rectangle, \
oriented parallel to the axes. \\n\!\(\*RowBox[{\\\"Rectangle\\\", \\\"[\\\", \
RowBox[{\\\"{\\\", RowBox[{SubscriptBox[StyleBox[\\\"x\\\", \\\"TI\\\"], \
StyleBox[\\\"min\\\", \\\"TI\\\"]], \\\",\\\", \
SubscriptBox[StyleBox[\\\"y\\\", \\\"TI\\\"], StyleBox[\\\"min\\\", \
\\\"TI\\\"]]}], \\\"}\\\"}], \\\"]\\\"}]\) corresponds to a unit square with \
its bottom-left corner at \!\(\*RowBox[{\\\"{\\\", \
RowBox[{SubscriptBox[StyleBox[\\\"x\\\", \\\"TI\\\"], StyleBox[\\\"min\\\", \
\\\"TI\\\"]], \\\",\\\", SubscriptBox[StyleBox[\\\"y\\\", \\\"TI\\\"], \
StyleBox[\\\"min\\\", \\\"TI\\\"]]}], \\\"}\\\"}]\).\"\>", "MSG"], 
  "\[NonBreakingSpace]", 
  ButtonBox[
   StyleBox["\[RightSkeleton]", "SR"],
   Active->True,
   BaseStyle->"Link",
   ButtonData->"paclet:ref/Rectangle"]}]], "Print", "PrintUsage",
 CellChangeTimes->{3.602611725208496*^9},
 CellTags->"Info3602586524-4346083"]
}, Open  ]],

Cell["\<\
Note that x and y refer to Cartesian coordinates, not screen coordinates. \
Beyond this data structure, we need several utility functions:\
\>", "Text",
 CellChangeTimes->{{3.602514066246089*^9, 3.602514093781376*^9}, {
  3.602514593525462*^9, 3.602514606861079*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Coord", "[", 
   RowBox[{"side_", ",", 
    RowBox[{"Rectangle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"xmin_", ",", "ymin_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"xmax_", ",", "ymax_"}], "}"}]}], "]"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Switch", "[", 
   RowBox[{
   "side", ",", "\[IndentingNewLine]", "Top", ",", "ymax", ",", 
    "\[IndentingNewLine]", "Bottom", ",", "ymin", ",", "\[IndentingNewLine]", 
    "Left", ",", "xmin", ",", "\[IndentingNewLine]", "Right", ",", "xmax"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.602514249279409*^9, 3.602514299271318*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Width", "[", "r_Rectangle", "]"}], ":=", 
  RowBox[{"Abs", "[", 
   RowBox[{
    RowBox[{"Coord", "[", 
     RowBox[{"Right", ",", "r"}], "]"}], "-", 
    RowBox[{"Coord", "[", 
     RowBox[{"Left", ",", "r"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6025140986873617`*^9, 3.602514126365499*^9}, {
  3.602514303736308*^9, 3.602514331840534*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Height", "[", "r_Rectangle", "]"}], ":=", 
  RowBox[{"Abs", "[", 
   RowBox[{
    RowBox[{"Coord", "[", 
     RowBox[{"Top", ",", "r"}], "]"}], "-", 
    RowBox[{"Coord", "[", 
     RowBox[{"Bottom", ",", "r"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.602514136041719*^9, 3.602514153257781*^9}, {
  3.602514334915262*^9, 3.602514353930279*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Area", "[", "r_Rectangle", "]"}], ":=", 
  RowBox[{
   RowBox[{"Width", "[", "r", "]"}], "\[Times]", 
   RowBox[{"Height", "[", "r", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.602514156050433*^9, 3.6025141732635*^9}}],

Cell["\<\
The aspect ratio of a rectangle is the proportion of the longest edge to the \
shorter edge (thus, the aspect ratio is always greater than or equal to one). \
For a degenerate rectangle (where either the height or width is zero), we \
will define the aspect ratio as infinite.\
\>", "Text",
 CellChangeTimes->{{3.602514487999433*^9, 3.602514531968882*^9}, {
  3.6025147738404093`*^9, 3.6025147972083683`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RectAspectRatio", "[", "r_Rectangle", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Which", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Width", "[", "r", "]"}], "\[Equal]", "0"}], "\[Or]", 
     RowBox[{
      RowBox[{"Height", "[", "r", "]"}], "\[Equal]", "0"}]}], ",", 
    "\[Infinity]", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Width", "[", "r", "]"}], "\[GreaterEqual]", 
     RowBox[{"Height", "[", "r", "]"}]}], ",", 
    RowBox[{
     RowBox[{"Width", "[", "r", "]"}], "/", 
     RowBox[{"Height", "[", "r", "]"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Width", "[", "r", "]"}], "<", 
     RowBox[{"Height", "[", "r", "]"}]}], ",", 
    RowBox[{
     RowBox[{"Height", "[", "r", "]"}], "/", 
     RowBox[{"Width", "[", "r", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.602514611789196*^9, 3.6025146358873034`*^9}, {
  3.602514677447462*^9, 3.60251473719063*^9}, {3.602514818784328*^9, 
  3.602514823319127*^9}}],

Cell[CellGroupData[{

Cell["Examples: Rectangle Functions", "Subsection",
 CellChangeTimes->{{3.602514937342263*^9, 3.602514949362136*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"r", "=", 
     RowBox[{"Rectangle", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"6", ",", "4"}], "}"}]}], "]"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Width", "[", "r", "]"}], ",", 
     RowBox[{"Height", "[", "r", "]"}], ",", 
     RowBox[{"Area", "[", "r", "]"}], ",", 
     RowBox[{"RectAspectRatio", "[", "r", "]"}]}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.602515023293647*^9, 3.602515058063097*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"6", ",", "4", ",", "24", ",", 
   FractionBox["3", "2"]}], "}"}]], "Output",
 CellChangeTimes->{3.602515058695375*^9, 3.602609245969575*^9, 
  3.602611725402454*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Sidebar: Visualization", "Section",
 CellChangeTimes->{{3.6025124309303007`*^9, 3.602512433483222*^9}}],

Cell[TextData[{
 "The algorithm presented in this paper is independent of a graphical \
rendering system. However, as we generate rectangles, it is useful to see \
them plotted for verification. The function below takes a list of rectangles \
and plots them, with axes and a gridline, using ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 "\[CloseCurlyQuote]s graphic capabilities."
}], "Text",
 CellChangeTimes->{{3.602515135558648*^9, 3.602515196242763*^9}, {
  3.6025152311015673`*^9, 3.602515274753561*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"VisualizeRectangles", "[", "rectangles_List", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Join", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EdgeForm", "[", 
         RowBox[{"{", 
          RowBox[{"Thick", ",", "Black"}], "}"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Opacity", "[", 
         RowBox[{"7", "/", "10"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Riffle", "[", 
       RowBox[{"rectangles", ",", 
        RowBox[{"ColorData", "[", 
         RowBox[{"\"\<Atoms\>\"", ",", "\"\<ColorList\>\""}], "]"}]}], 
       "]"}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Axes", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
    RowBox[{"GridLines", "\[Rule]", "Automatic"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.602515278425621*^9, 3.602515336023107*^9}, {
  3.6025154173202744`*^9, 3.602515443053116*^9}, {3.602515497079618*^9, 
  3.6025155330085278`*^9}, {3.602515568790036*^9, 3.602515586754239*^9}, {
  3.60251562710681*^9, 3.60251568403454*^9}, {3.6025157303815317`*^9, 
  3.6025157324099073`*^9}, {3.602515788417534*^9, 3.602515789191833*^9}}],

Cell["As an example of the output:", "Text",
 CellChangeTimes->{{3.6025158046922827`*^9, 3.602515809390152*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"VisualizeRectangles", "[", "\[IndentingNewLine]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Rectangle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"6", ",", "4"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Rectangle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "2"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Rectangle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "4"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Rectangle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"3", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"33", "/", "7"}], ",", 
        RowBox[{"7", "/", "3"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Rectangle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"33", "/", "7"}], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"6", ",", 
        RowBox[{"7", "/", "3"}]}], "}"}]}], "]"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.602515338112273*^9, 3.602515408705777*^9}}],

Cell[BoxData[
 GraphicsBox[
  {Opacity[
    NCache[
     Rational[7, 10], 0.7]], EdgeForm[{GrayLevel[0], Thickness[Large]}], 
   RectangleBox[{0, 0}, {6, 4}], 
   {RGBColor[0.65, 0.7, 0.7], RectangleBox[{0, 0}, {3, 2}]}, 
   {RGBColor[0.836713, 1., 1.], RectangleBox[{0, 2}, {3, 4}]}, 
   {RGBColor[0.799435, 0.543572, 0.997559], 
    RectangleBox[{3, 0}, 
     NCache[{Rational[33, 7], Rational[7, 3]}, {4.714285714285714, 
      2.3333333333333335`}]]}, 
   {RGBColor[0.770565, 0.964309, 0.0442359], 
    RectangleBox[NCache[{Rational[33, 7], 0}, {4.714285714285714, 0}], 
     NCache[{6, Rational[7, 3]}, {6, 2.3333333333333335`}]]}},
  Axes->True,
  GridLines->Automatic]], "Output",
 CellChangeTimes->{{3.602515409402169*^9, 3.602515445548841*^9}, {
   3.602515501469252*^9, 3.602515534721202*^9}, {3.602515573001834*^9, 
   3.602515588405188*^9}, {3.6025156314626827`*^9, 3.602515638642147*^9}, {
   3.602515670836679*^9, 3.602515686030405*^9}, 3.602515734677187*^9, 
   3.602515790798029*^9, 3.602609246030719*^9, 3.602611725460681*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Filling a Rectangle", "Section",
 CellChangeTimes->{{3.602512437622459*^9, 3.6025124402294064`*^9}}],

Cell["\<\
Given a rectangle and a list of desired areas for sub-rectangles (the sum of \
those areas is equal to or less than the area of the parent rectangle), we \
can iteratively fill the parent rectangle with child rectangles. For the \
squarified treemap algorithm, we fill in rectangles either vertically (stack \
children on top of each other, flushed to the left) or horizontally (stack \
children to the right of each other, flush to the left and right edges and \
growing upwards).\
\>", "Text",
 CellChangeTimes->{{3.602521732520616*^9, 3.602521830525378*^9}, {
  3.602521868782551*^9, 3.60252189247863*^9}}],

Cell["\<\
In the vertical case, the height of each rectangle is proportional and scaled \
to the total areas of the children and the fixed height of the parent. \
Contrawise, in the horizontal case, the widths of each rectangles are \
proportional and scaled to the fixed width of the parent. Within these \
constraints, the width or height (respectively) can be computed using the \
child\[CloseCurlyQuote]s desired area.\
\>", "Text",
 CellChangeTimes->{{3.602521931954714*^9, 3.602522075430972*^9}, {
  3.602528070519577*^9, 3.6025280706846952`*^9}}],

Cell[CellGroupData[{

Cell["Fill Vertically", "Subsection",
 CellChangeTimes->{{3.6025221581371937`*^9, 3.60252217392708*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FillRectangle", "[", 
   RowBox[{"parent_Rectangle", ",", 
    RowBox[{"{", "}"}], ",", "Vertical"}], "]"}], ":=", 
  RowBox[{"{", "}"}]}]], "Input",
 CellChangeTimes->{{3.6025221220406637`*^9, 3.60252213279101*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FillRectangle", "[", 
   RowBox[{"parent_Rectangle", ",", "areas_List", ",", "Vertical"}], "]"}], ":=",
   "\[IndentingNewLine]", 
  RowBox[{"Block", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"heights", "=", 
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Height", "[", "parent", "]"}], "*", 
         RowBox[{
          RowBox[{"Accumulate", "[", "areas", "]"}], "/", 
          RowBox[{"Total", "[", "areas", "]"}]}]}], ",", "0"}], "]"}]}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Rectangle", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Coord", "[", 
           RowBox[{"Left", ",", "parent"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Coord", "[", 
            RowBox[{"Bottom", ",", "parent"}], "]"}], "+", 
           RowBox[{"heights", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Coord", "[", 
            RowBox[{"Left", ",", "parent"}], "]"}], "+", 
           RowBox[{
            RowBox[{"areas", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"heights", "[", 
               RowBox[{"[", 
                RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", 
              RowBox[{"heights", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Coord", "[", 
            RowBox[{"Bottom", ",", "parent"}], "]"}], "+", 
           RowBox[{"heights", "[", 
            RowBox[{"[", 
             RowBox[{"i", "+", "1"}], "]"}], "]"}]}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{
         RowBox[{"Length", "[", "heights", "]"}], "-", "1"}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 CellChangeTimes->{{3.60252216559378*^9, 3.602522324750126*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Fill Horizontally", "Subsection",
 CellChangeTimes->{{3.602522331273534*^9, 3.602522335438644*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FillRectangle", "[", 
   RowBox[{"parent_Rectangle", ",", 
    RowBox[{"{", "}"}], ",", "Horizontal"}], "]"}], ":=", 
  RowBox[{"{", "}"}]}]], "Input",
 CellChangeTimes->{{3.602522342061584*^9, 3.60252235170019*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FillRectangle", "[", 
   RowBox[{"parent_Rectangle", ",", "areas_List", ",", "Horizontal"}], "]"}], 
  ":=", "\[IndentingNewLine]", 
  RowBox[{"Block", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"widths", "=", 
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Width", "[", "parent", "]"}], "*", 
         RowBox[{
          RowBox[{"Accumulate", "[", "areas", "]"}], "/", 
          RowBox[{"Total", "[", "areas", "]"}]}]}], ",", "0"}], "]"}]}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Rectangle", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Coord", "[", 
            RowBox[{"Left", ",", "parent"}], "]"}], "+", 
           RowBox[{"widths", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Coord", "[", 
           RowBox[{"Bottom", ",", "parent"}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Coord", "[", 
            RowBox[{"Left", ",", "parent"}], "]"}], "+", 
           RowBox[{"widths", "[", 
            RowBox[{"[", 
             RowBox[{"i", "+", "1"}], "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Coord", "[", 
            RowBox[{"Bottom", ",", "parent"}], "]"}], "+", 
           RowBox[{
            RowBox[{"areas", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"widths", "[", 
               RowBox[{"[", 
                RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", 
              RowBox[{"widths", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}]}]}], "}"}]}], 
       "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{
         RowBox[{"Length", "[", "widths", "]"}], "-", "1"}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 CellChangeTimes->{{3.60252235450422*^9, 3.6025225367351723`*^9}, {
  3.602522751449252*^9, 3.602522752332734*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Examples: Fill Horizontally and Vertically\
\>", "Subsection",
 CellChangeTimes->{{3.602522546907572*^9, 3.6025225625755053`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"parent", "=", 
      RowBox[{"Rectangle", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"6", ",", "4"}], "}"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"p2", "=", 
      RowBox[{"Rectangle", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"3", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"6", ",", "4"}], "}"}]}], "]"}]}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"GraphicsRow", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"VisualizeRectangles", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", "parent", "}"}], ",", 
          RowBox[{"FillRectangle", "[", 
           RowBox[{"parent", ",", 
            RowBox[{"{", "6", "}"}], ",", "Vertical"}], "]"}]}], "]"}], "]"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{"VisualizeRectangles", "[", "\[IndentingNewLine]", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", "parent", "}"}], ",", 
          RowBox[{"FillRectangle", "[", 
           RowBox[{"parent", ",", 
            RowBox[{"{", 
             RowBox[{"6", ",", "6"}], "}"}], ",", "Vertical"}], "]"}]}], 
         "]"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"VisualizeRectangles", "[", "\[IndentingNewLine]", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", "parent", "}"}], ",", 
          RowBox[{"FillRectangle", "[", 
           RowBox[{"parent", ",", 
            RowBox[{"{", 
             RowBox[{"6", ",", "6", ",", "4"}], "}"}], ",", "Vertical"}], 
           "]"}]}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"VisualizeRectangles", "[", "\[IndentingNewLine]", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", "parent", "}"}], ",", 
          RowBox[{"FillRectangle", "[", 
           RowBox[{"p2", ",", 
            RowBox[{"{", "4", "}"}], ",", "Horizontal"}], "]"}]}], "]"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"VisualizeRectangles", "[", "\[IndentingNewLine]", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", "parent", "}"}], ",", 
          RowBox[{"FillRectangle", "[", 
           RowBox[{"p2", ",", 
            RowBox[{"{", 
             RowBox[{"4", ",", "3"}], "}"}], ",", "Horizontal"}], "]"}]}], 
         "]"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Spacings", "\[Rule]", "0"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.602522589250082*^9, 3.602522718517283*^9}, {
  3.6025227820603933`*^9, 3.602522949079773*^9}, {3.602523180178748*^9, 
  3.602523222517927*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {InsetBox[
     GraphicsBox[
      {Opacity[
        NCache[
         Rational[7, 10], 0.7]], EdgeForm[{GrayLevel[0], Thickness[Large]}], 
       RectangleBox[{0, 0}, {6, 4}], 
       {RGBColor[0.65, 0.7, 0.7], 
        RectangleBox[{0, 0}, NCache[{Rational[3, 2], 4}, {1.5, 4}]]}},
      Axes->True,
      GridLines->Automatic], {180, -126.}, 
     ImageScaled[{0.5, 0.5}], {360, 240.}], InsetBox[
     GraphicsBox[
      {Opacity[
        NCache[
         Rational[7, 10], 0.7]], EdgeForm[{GrayLevel[0], Thickness[Large]}], 
       RectangleBox[{0, 0}, {6, 4}], 
       {RGBColor[0.65, 0.7, 0.7], RectangleBox[{0, 0}, {3, 2}]}, 
       {RGBColor[0.836713, 1., 1.], RectangleBox[{0, 2}, {3, 4}]}},
      Axes->True,
      GridLines->Automatic], {540, -126.}, 
     ImageScaled[{0.5, 0.5}], {360, 240.}], InsetBox[
     GraphicsBox[
      {Opacity[
        NCache[
         Rational[7, 10], 0.7]], EdgeForm[{GrayLevel[0], Thickness[Large]}], 
       RectangleBox[{0, 0}, {6, 4}], 
       {RGBColor[0.65, 0.7, 0.7], 
        RectangleBox[{0, 0}, NCache[{4, Rational[3, 2]}, {4, 1.5}]]}, 
       {RGBColor[0.836713, 1., 1.], 
        RectangleBox[NCache[{0, Rational[3, 2]}, {0, 1.5}], {4, 3}]}, 
       {RGBColor[0.799435, 0.543572, 0.997559], RectangleBox[{0, 3}, {4, 4}]}},
      Axes->True,
      GridLines->Automatic], {900, -126.}, 
     ImageScaled[{0.5, 0.5}], {360, 240.}], InsetBox[
     GraphicsBox[
      {Opacity[
        NCache[
         Rational[7, 10], 0.7]], EdgeForm[{GrayLevel[0], Thickness[Large]}], 
       RectangleBox[{0, 0}, {6, 4}], 
       {RGBColor[0.65, 0.7, 0.7], 
        RectangleBox[{3, 0}, 
         NCache[{6, Rational[4, 3]}, {6, 1.3333333333333333`}]]}},
      Axes->True,
      GridLines->Automatic], {1260, -126.}, 
     ImageScaled[{0.5, 0.5}], {360, 240.}], InsetBox[
     GraphicsBox[
      {Opacity[
        NCache[
         Rational[7, 10], 0.7]], EdgeForm[{GrayLevel[0], Thickness[Large]}], 
       RectangleBox[{0, 0}, {6, 4}], 
       {RGBColor[0.65, 0.7, 0.7], 
        RectangleBox[{3, 0}, 
         NCache[{Rational[33, 7], Rational[7, 3]}, {4.714285714285714, 
          2.3333333333333335`}]]}, 
       {RGBColor[0.836713, 1., 1.], 
        RectangleBox[NCache[{Rational[33, 7], 0}, {4.714285714285714, 0}], 
         NCache[{6, Rational[7, 3]}, {6, 2.3333333333333335`}]]}},
      Axes->True,
      GridLines->Automatic], {1620, -126.}, 
     ImageScaled[{0.5, 0.5}], {360, 240.}]}, {}},
  ContentSelectable->True,
  ImageSize->Large,
  PlotRangePadding->{6, 5}]], "Output",
 CellChangeTimes->{{3.602522669102851*^9, 3.602522684075815*^9}, 
   3.602522719186677*^9, 3.602522760020602*^9, 3.602522806317026*^9, {
   3.6025228534345217`*^9, 3.602522949547872*^9}, {3.602523200629318*^9, 
   3.6025232363145742`*^9}, 3.6026092461260023`*^9, 3.6026117255503073`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["How Many Children?", "Section",
 CellChangeTimes->{{3.6025124502226477`*^9, 3.602512469353609*^9}}],

Cell["\<\
We can add all children to a rectangle using the same orientation. However, \
this leads to narrow rectangles that hard to compare:\
\>", "Text",
 CellChangeTimes->{{3.6025230342121363`*^9, 3.602523070017714*^9}, {
  3.602523156867543*^9, 3.602523158363978*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Block", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"parent", "=", 
     RowBox[{"Rectangle", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"6", ",", "4"}], "}"}]}], "]"}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"VisualizeRectangles", "[", "\[IndentingNewLine]", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", "parent", "}"}], ",", 
      RowBox[{"FillRectangle", "[", 
       RowBox[{"parent", ",", 
        RowBox[{"{", 
         RowBox[{
         "6", ",", "6", ",", "4", ",", "3", ",", "2", ",", "2", ",", "1"}], 
         "}"}], ",", "Horizontal"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.602523075173811*^9, 3.602523132934539*^9}}],

Cell[BoxData[
 GraphicsBox[
  {Opacity[
    NCache[
     Rational[7, 10], 0.7]], EdgeForm[{GrayLevel[0], Thickness[Large]}], 
   RectangleBox[{0, 0}, {6, 4}], 
   {RGBColor[0.65, 0.7, 0.7], 
    RectangleBox[{0, 0}, NCache[{Rational[3, 2], 4}, {1.5, 4}]]}, 
   {RGBColor[0.836713, 1., 1.], 
    RectangleBox[NCache[{Rational[3, 2], 0}, {1.5, 0}], {3, 4}]}, 
   {RGBColor[0.799435, 0.543572, 0.997559], RectangleBox[{3, 0}, {4, 4}]}, 
   {RGBColor[0.770565, 0.964309, 0.0442359], 
    RectangleBox[{4, 0}, NCache[{Rational[19, 4], 4}, {4.75, 4}]]}, 
   {RGBColor[1., 0.709804, 0.709804], 
    RectangleBox[NCache[{Rational[19, 4], 0}, {4.75, 0}], 
     NCache[{Rational[21, 4], 4}, {5.25, 4}]]}, 
   {RGBColor[0.4, 0.4, 0.4], 
    RectangleBox[NCache[{Rational[21, 4], 0}, {5.25, 0}], 
     NCache[{Rational[23, 4], 4}, {5.75, 4}]]}, 
   {RGBColor[0.291989, 0.437977, 0.888609], 
    RectangleBox[NCache[{Rational[23, 4], 0}, {5.75, 0}], {6, 4}]}},
  Axes->True,
  GridLines->Automatic]], "Output",
 CellChangeTimes->{{3.602523115208528*^9, 3.602523133442443*^9}, 
   3.602609246193885*^9, 3.602611725614806*^9}]
}, Open  ]],

Cell["\<\
The squarified treemap algorithm uses a heuristic to first fill a rectangle \
with children using one orientation, then switch to the opposite orientation, \
and so on. The algorithm places a child rectangles until the worst aspect \
ratio of the group of placed rectangles increases. In other words, rectangles \
are placed until a local minima of the aspect ratio is found. The worst \
aspect ratio is simply the maximum aspect ratio of a list. If the list is \
empty, we define the worst aspect ratio as infinite.\
\>", "Text",
 CellChangeTimes->{{3.6025232738861933`*^9, 3.6025233924873543`*^9}, {
  3.602523443302471*^9, 3.602523456569922*^9}, {3.602523614827455*^9, 
  3.6025236236586943`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"WorstAspectRatio", "[", 
   RowBox[{"{", "}"}], "]"}], ":=", "\[Infinity]"}]], "Input",
 CellChangeTimes->{{3.602523626808999*^9, 3.602523632918088*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"WorstAspectRatio", "[", "rectangles_List", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Max", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"RectAspectRatio", "[", "#", "]"}], "&"}], "/@", "rectangles"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.602523409481268*^9, 3.602523428986751*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PlaceTillLocalMinima", "[", 
   RowBox[{"parent_Rectangle", ",", "areas_List", ",", "orientation_"}], 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"PlaceTillLocalMinima", "[", 
   RowBox[{"parent", ",", "areas", ",", "orientation", ",", 
    RowBox[{"{", "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6025236637728662`*^9, 3.602523697284738*^9}, {
  3.6025237438756742`*^9, 3.602523766666615*^9}}],

Cell["\<\
The PlaceTillLocalMinima (4 argument) function takes a parent rectangle, a \
list of desired areas for child rectangles, an orientation (either Vertical \
or Horizontal), and accumulates a list of rectangles placed using \
FillRectangle.\
\>", "Text",
 CellChangeTimes->{{3.602523800164146*^9, 3.602523871185348*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PlaceTillLocalMinima", "[", 
   RowBox[{
   "parent_Rectangle", ",", "areas_List", ",", "orientation_", ",", 
    "placed_List"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "placed", "]"}], "\[Equal]", 
     RowBox[{"Length", "[", "areas", "]"}]}], ",", "placed", " ", 
    RowBox[{"(*", " ", 
     RowBox[{"local", " ", "minima", " ", "achieved"}], " ", "*)"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Block", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"placeStep", "=", 
        RowBox[{"FillRectangle", "[", 
         RowBox[{"parent", ",", 
          RowBox[{"Take", "[", 
           RowBox[{"areas", ",", 
            RowBox[{
             RowBox[{"Length", "[", "placed", "]"}], "+", "1"}]}], "]"}], ",",
           "orientation"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"WorstAspectRatio", "[", "placeStep", "]"}], ">", 
         RowBox[{"WorstAspectRatio", "[", "placed", "]"}]}], ",", 
        "\[IndentingNewLine]", "placed", 
        RowBox[{"(*", 
         RowBox[{
         "previous", " ", "step", " ", "had", " ", "local", " ", "minima"}], 
         "*)"}], ",", "\[IndentingNewLine]", 
        RowBox[{"PlaceTillLocalMinima", "[", 
         RowBox[{
         "parent", ",", "areas", ",", "orientation", ",", "placeStep"}], 
         "]"}]}], 
       RowBox[{"(*", 
        RowBox[{
        "recurse", " ", "and", " ", "check", " ", "if", " ", "next", " ", 
         "step", " ", "is", " ", "local", " ", "minima"}], "*)"}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6025237702297897`*^9, 3.602523791086747*^9}, {
  3.6025238915261497`*^9, 3.602523941789757*^9}, {3.602524026759266*^9, 
  3.602524190076623*^9}}],

Cell["\<\
When a local minima is found, the upper-level function will place the \
remaining children using the opposite orientation. This function provides the \
flip:\
\>", "Text",
 CellChangeTimes->{{3.602524519734888*^9, 3.602524551155402*^9}, {
  3.602528093366803*^9, 3.6025280943208857`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"InvertOrientation", "[", "Horizontal", "]"}], ":=", 
  "Vertical"}]], "Input",
 CellChangeTimes->{{3.602524554015004*^9, 3.6025245606417093`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"InvertOrientation", "[", "Vertical", "]"}], ":=", 
  "Horizontal"}]], "Input",
 CellChangeTimes->{{3.6025245618519983`*^9, 3.602524568401902*^9}}],

Cell[CellGroupData[{

Cell["Examples: Finding Local Minima", "Subsection",
 CellChangeTimes->{{3.602524224046068*^9, 3.60252422740632*^9}}],

Cell["\<\
The function finds that placing just the first two rectangles reaches the \
local minima:\
\>", "Text",
 CellChangeTimes->{{3.602524411478763*^9, 3.602524425950039*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PlaceTillLocalMinima", "[", 
  RowBox[{
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "4"}], "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "6", ",", "4", ",", "3", ",", "2", ",", "2", ",", "1"}],
     "}"}], ",", "Vertical"}], "]"}]], "Input",
 CellChangeTimes->{{3.602464559100952*^9, 3.602464601556774*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "2"}], "}"}]}], "]"}], ",", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.602524266332905*^9, 3.602524296435762*^9, 
  3.6026092462839003`*^9, 3.602611725674934*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"WorstAspectRatio", "[", "%", "]"}]], "Input",
 CellChangeTimes->{{3.602524284510524*^9, 3.602524288160162*^9}}],

Cell[BoxData[
 FractionBox["3", "2"]], "Output",
 CellChangeTimes->{{3.602524288632613*^9, 3.602524299016632*^9}, 
   3.602609246327647*^9, 3.602611725681018*^9}]
}, Open  ]],

Cell["\<\
The worst aspect ratio for the next step (placing 6, 6, and 4) is 4, which is \
greater than 3/2.\
\>", "Text",
 CellChangeTimes->{{3.602524431733433*^9, 3.60252445372563*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"WorstAspectRatio", "[", 
  RowBox[{"FillRectangle", "[", 
   RowBox[{
    RowBox[{"Rectangle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"6", ",", "4"}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"6", ",", "6", ",", "4"}], "}"}], ",", "Vertical"}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.60252430365768*^9, 3.602524345457383*^9}}],

Cell[BoxData["4"], "Output",
 CellChangeTimes->{{3.602524333796616*^9, 3.602524345958424*^9}, 
   3.602609246334551*^9, 3.602611725712879*^9}]
}, Open  ]],

Cell["\<\
Similarly, the function finds the local minima after the first two rectangles:\
\>", "Text",
 CellChangeTimes->{{3.602524461783741*^9, 3.6025244750465183`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PlaceTillLocalMinima", "[", 
  RowBox[{
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "4"}], "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "3", ",", "2", ",", "1", ",", "1"}], "}"}], ",", 
   "Horizontal"}], "]"}]], "Input",
 CellChangeTimes->{{3.6024649260007553`*^9, 3.602464975992446*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       FractionBox["33", "7"], ",", 
       FractionBox["7", "3"]}], "}"}]}], "]"}], ",", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       FractionBox["33", "7"], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", 
       FractionBox["7", "3"]}], "}"}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6025242748034897`*^9, 3.602524352226582*^9, 
  3.602609246372916*^9, 3.602611725752201*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"WorstAspectRatio", "[", "%", "]"}]], "Input",
 CellChangeTimes->{{3.602524354322002*^9, 3.6025243587070417`*^9}}],

Cell[BoxData[
 FractionBox["49", "27"]], "Output",
 CellChangeTimes->{3.6025243592168827`*^9, 3.602609246417568*^9, 
  3.6026117257593403`*^9}]
}, Open  ]],

Cell["\<\
The worst aspect ratio for the next step (4, 3, and 2) is 9/2, which is \
greater than 49/27.\
\>", "Text",
 CellChangeTimes->{{3.602524480619894*^9, 3.602524497050688*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"WorstAspectRatio", "[", 
  RowBox[{"FillRectangle", "[", 
   RowBox[{
    RowBox[{"Rectangle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"3", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"6", ",", "4"}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"4", ",", "3", ",", "2"}], "}"}], ",", "Horizontal"}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.602524369440652*^9, 3.602524395754919*^9}}],

Cell[BoxData[
 FractionBox["9", "2"]], "Output",
 CellChangeTimes->{{3.6025243913610563`*^9, 3.6025243962292767`*^9}, 
   3.602609246456388*^9, 3.602611725789735*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Calculating Remaining Dimensions\
\>", "Section",
 CellChangeTimes->{{3.602512475795643*^9, 3.602512485641571*^9}, {
  3.6025247854485064`*^9, 3.602524790368075*^9}}],

Cell["\<\
After the algorithm has placed a number of children, it will invert \
orientation and place the remaining children. The parent rectangle for the \
first group of children is different than the second group (and the third and \
fourth...) because some of the space has already been consumed. These pair of \
functions are used to calculate the \[OpenCurlyDoubleQuote]new\
\[CloseCurlyDoubleQuote] parent rectangle for the next iteration of rectangle \
placing.\
\>", "Text",
 CellChangeTimes->{{3.602524805925159*^9, 3.6025248831558437`*^9}, {
  3.602524929891733*^9, 3.6025249594868107`*^9}}],

Cell["\<\
First, given a group of placed rectangles, we need to find the bounding box \
around them. Due to the algorithm\[CloseCurlyQuote]s design, the bounding box \
will always be a rectangle flush with the child rectangles.\
\>", "Text",
 CellChangeTimes->{{3.602524971281434*^9, 3.6025250335734253`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"EnclosingRectangle", "[", "rectangles_List", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Rectangle", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Min", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Coord", "[", 
          RowBox[{"Left", ",", "#"}], "]"}], "&"}], "/@", "rectangles"}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Min", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Coord", "[", 
          RowBox[{"Bottom", ",", "#"}], "]"}], "&"}], "/@", "rectangles"}], 
       "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Max", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Coord", "[", 
          RowBox[{"Right", ",", "#"}], "]"}], "&"}], "/@", "rectangles"}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Max", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Coord", "[", 
          RowBox[{"Top", ",", "#"}], "]"}], "&"}], "/@", "rectangles"}], 
       "]"}]}], "}"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.602524989956271*^9, 3.6025249973507147`*^9}, {
  3.602525038278016*^9, 3.602525091143862*^9}}],

Cell["\<\
Second, the remaining rectangle is formed from the right edge of the child \
(if the children were placed Vertically) or from the top edge of the child \
(if the children were placed Horizontally). The top-right corner is always \
equal to the parent.\
\>", "Text",
 CellChangeTimes->{{3.6025252130227823`*^9, 3.602525214862007*^9}, {
  3.6025252460093412`*^9, 3.602525333697448*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RemainingRectangle", "[", 
   RowBox[{"parent_Rectangle", ",", "child_Rectangle"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Rectangle", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Coord", "[", 
           RowBox[{"Bottom", ",", "parent"}], "]"}], "\[Equal]", 
          RowBox[{"Coord", "[", 
           RowBox[{"Bottom", ",", "child"}], "]"}]}], "\[And]", 
         RowBox[{
          RowBox[{"Coord", "[", 
           RowBox[{"Top", ",", "parent"}], "]"}], "\[Equal]", 
          RowBox[{"Coord", "[", 
           RowBox[{"Top", ",", "child"}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Coord", "[", 
         RowBox[{"Right", ",", "child"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", "else", "*)"}], 
        RowBox[{"Coord", "[", 
         RowBox[{"Left", ",", "parent"}], "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Coord", "[", 
           RowBox[{"Left", ",", "parent"}], "]"}], "\[Equal]", 
          RowBox[{"Coord", "[", 
           RowBox[{"Left", ",", "child"}], "]"}]}], "\[And]", 
         RowBox[{
          RowBox[{"Coord", "[", 
           RowBox[{"Right", ",", "parent"}], "]"}], "\[Equal]", 
          RowBox[{"Coord", "[", 
           RowBox[{"Right", ",", "child"}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Coord", "[", 
         RowBox[{"Top", ",", "child"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", "else", "*)"}], 
        RowBox[{"Coord", "[", 
         RowBox[{"Bottom", ",", "parent"}], "]"}]}], "\[IndentingNewLine]", 
       "]"}]}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Coord", "[", 
       RowBox[{"Right", ",", "parent"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Coord", "[", 
       RowBox[{"Top", ",", "parent"}], "]"}]}], "}"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.602525341108864*^9, 3.602525552121573*^9}, {
   3.6025256291924133`*^9, 3.602525631395536*^9}, {3.602525730886643*^9, 
   3.602525797377911*^9}, {3.6025258704702177`*^9, 3.602525906579726*^9}, 
   3.6025281158347387`*^9}],

Cell[CellGroupData[{

Cell["Examples: Remaining Rectangle", "Subsection",
 CellChangeTimes->{{3.602525559447259*^9, 3.602525564062153*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EnclosingRectangle", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Rectangle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "2"}], "}"}]}], "]"}], ",", 
    RowBox[{"Rectangle", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "4"}], "}"}]}], "]"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.602508564206484*^9, 3.602508580703615*^9}}],

Cell[BoxData[
 RowBox[{"Rectangle", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4"}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{3.602525580524671*^9, 3.6025256340417013`*^9, 
  3.6026092465471*^9, 3.602611725847911*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RemainingRectangle", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "4"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6025095349528103`*^9, 3.6025095709879093`*^9}, {
  3.602525679824584*^9, 3.602525682392097*^9}}],

Cell[BoxData[
 RowBox[{"Rectangle", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"3", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "4"}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.602525592859537*^9, {3.602525636405671*^9, 3.602525637954722*^9}, 
   3.602525683037286*^9, {3.6025257868083277`*^9, 3.602525801335484*^9}, 
   3.602525915092927*^9, 3.6026092465836067`*^9, 3.602611725855096*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RemainingRectangle", "[", 
  RowBox[{
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "4"}], "}"}]}], "]"}], ",", 
   RowBox[{"EnclosingRectangle", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Rectangle", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"3", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          FractionBox["33", "7"], ",", 
          FractionBox["7", "3"]}], "}"}]}], "]"}], ",", 
      RowBox[{"Rectangle", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          FractionBox["33", "7"], ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"6", ",", 
          FractionBox["7", "3"]}], "}"}]}], "]"}]}], "}"}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.602509594629032*^9, 3.602509607460833*^9}, {
  3.602509650364799*^9, 3.6025096535873938`*^9}}],

Cell[BoxData[
 RowBox[{"Rectangle", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"3", ",", 
     FractionBox["7", "3"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "4"}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{3.602525928469672*^9, 3.6026092466770687`*^9, 
  3.6026117258920317`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RemainingRectangle", "[", 
  RowBox[{
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], "]"}], ",", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.602509673908774*^9, 3.6025096981155024`*^9}}],

Cell[BoxData[
 RowBox[{"Rectangle", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{3.602525942830286*^9, 3.6026092466840487`*^9, 
  3.60261172589953*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Squarify Algorithm", "Section",
 CellChangeTimes->{{3.602512491102111*^9, 3.602512495966441*^9}}],

Cell["\<\
With all the pieces together, we can now write the Squarify function. This \
function takes a parent rectangle and a list of areas (whose sum must equal \
the area of the parent) and returns a list of Rectangles.\
\>", "Text",
 CellChangeTimes->{{3.602526064955402*^9, 3.602526111246966*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Squarify", "[", 
   RowBox[{"parent_Rectangle", ",", "areas_List"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Squarify", "[", 
   RowBox[{"parent", ",", "areas", ",", 
    RowBox[{"{", "}"}], ",", "Vertical"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.602526115517047*^9, 3.602526130735602*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Squarify", "[", 
   RowBox[{
   "parent_Rectangle", ",", "areas_List", ",", "placed_List", ",", 
    "orientation_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "areas", "]"}], "\[Equal]", "0"}], ",", "placed", 
    
    RowBox[{"(*", "done", "*)"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Block", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"placeThisStep", "=", 
        RowBox[{"PlaceTillLocalMinima", "[", 
         RowBox[{"parent", ",", "areas", ",", "orientation"}], "]"}]}], "}"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{"Squarify", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"RemainingRectangle", "[", 
         RowBox[{"parent", ",", 
          RowBox[{"EnclosingRectangle", "[", "placeThisStep", "]"}]}], "]"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"Drop", "[", 
         RowBox[{"areas", ",", 
          RowBox[{"Length", "[", "placeThisStep", "]"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Join", "[", 
         RowBox[{"placed", ",", "placeThisStep"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"InvertOrientation", "[", "orientation", "]"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.60252613590569*^9, 3.602526238114336*^9}}],

Cell[CellGroupData[{

Cell["Example: Squarify", "Subsection",
 CellChangeTimes->{{3.602526247588767*^9, 3.602526252113686*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Squarify", "[", 
  RowBox[{
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "4"}], "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "6", ",", "4", ",", "3", ",", "2", ",", "2", ",", "1"}],
     "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.602526257658289*^9, 3.6025262731962957`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "2"}], "}"}]}], "]"}], ",", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}]}], "]"}], ",", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       FractionBox["33", "7"], ",", 
       FractionBox["7", "3"]}], "}"}]}], "]"}], ",", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       FractionBox["33", "7"], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", 
       FractionBox["7", "3"]}], "}"}]}], "]"}], ",", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", 
       FractionBox["7", "3"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       FractionBox["21", "5"], ",", "4"}], "}"}]}], "]"}], ",", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       FractionBox["21", "5"], ",", 
       FractionBox["7", "3"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", 
       FractionBox["31", "9"]}], "}"}]}], "]"}], ",", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       FractionBox["21", "5"], ",", 
       FractionBox["31", "9"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "4"}], "}"}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.602526274535469*^9, 3.6026092467652903`*^9, 
  3.602611725970392*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"VisualizeRectangles", "[", "%", "]"}]], "Input",
 CellChangeTimes->{{3.602526278503984*^9, 3.602526281898493*^9}}],

Cell[BoxData[
 GraphicsBox[
  {Opacity[
    NCache[
     Rational[7, 10], 0.7]], EdgeForm[{GrayLevel[0], Thickness[Large]}], 
   RectangleBox[{0, 0}, {3, 2}], 
   {RGBColor[0.65, 0.7, 0.7], RectangleBox[{0, 2}, {3, 4}]}, 
   {RGBColor[0.836713, 1., 1.], 
    RectangleBox[{3, 0}, 
     NCache[{Rational[33, 7], Rational[7, 3]}, {4.714285714285714, 
      2.3333333333333335`}]]}, 
   {RGBColor[0.799435, 0.543572, 0.997559], 
    RectangleBox[NCache[{Rational[33, 7], 0}, {4.714285714285714, 0}], 
     NCache[{6, Rational[7, 3]}, {6, 2.3333333333333335`}]]}, 
   {RGBColor[0.770565, 0.964309, 0.0442359], 
    RectangleBox[NCache[{3, Rational[7, 3]}, {3, 2.3333333333333335`}], 
     NCache[{Rational[21, 5], 4}, {4.2, 4}]]}, 
   {RGBColor[1., 0.709804, 0.709804], 
    RectangleBox[
     NCache[{Rational[21, 5], Rational[7, 3]}, {4.2, 2.3333333333333335`}], 
     NCache[{6, Rational[31, 9]}, {6, 3.4444444444444446`}]]}, 
   {RGBColor[0.4, 0.4, 0.4], 
    RectangleBox[
     NCache[{Rational[21, 5], Rational[31, 9]}, {4.2, 
      3.4444444444444446`}], {6, 4}]}},
  Axes->True,
  GridLines->Automatic]], "Output",
 CellChangeTimes->{3.602526282371521*^9, 3.602609246840645*^9, 
  3.6026117260231113`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Squarify with Hierarchy", "Section",
 CellChangeTimes->{{3.60260928280377*^9, 3.602609286821434*^9}}],

Cell["\<\
The version of Squarify defined in the previous section recursively breaks a \
rectangle into multiple subrectangles given a single list (layer) of areas. \
However, the original goal of treemaps was to show multiple layers of \
hierarchy -- demonstrate the concepts of membership and scale simultaneously.\
\
\>", "Text",
 CellChangeTimes->{{3.602609289887442*^9, 3.602609362276601*^9}, {
  3.602609400962036*^9, 3.602609404445197*^9}, {3.602609793985527*^9, 
  3.60260980682299*^9}, {3.602609900681693*^9, 3.6026099206007833`*^9}}],

Cell[CellGroupData[{

Cell["Encoding Hierarchy", "Subsection",
 CellChangeTimes->{{3.602610504969565*^9, 3.602610507337888*^9}}],

Cell[TextData[{
 "In order to encode hierarchy, we will expand our earlier areas list into \
lists of lists. ",
 StyleBox["areas",
  FontSlant->"Italic"],
 " is a list consisting of either positive numbers or lists. If a list, that \
list may contain either positive numbers or lists. The sum of numbers in all \
the lists should be equal to or less than the area of the parent rectangle."
}], "Text",
 CellChangeTimes->{{3.602609934886407*^9, 3.602610095946031*^9}, {
  3.602610428069777*^9, 3.602610458614872*^9}}],

Cell[TextData[{
 "For example, the list ",
 StyleBox["hierarchicalData",
  FontSlant->"Italic"],
 " will serve as an example."
}], "Text",
 CellChangeTimes->{{3.602610113706769*^9, 3.602610134106113*^9}, {
  3.602610351858715*^9, 3.6026104130911007`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"hierarchicalData", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"4", ",", "3", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "7", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"9", ",", "8"}], "}"}]}], "}"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.60261013707339*^9, 3.6026101797267857`*^9}, {
  3.6026104150115128`*^9, 3.602610416551371*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{"hierarchicalData", ",", "\[Infinity]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6026101958394957`*^9, 3.602610197718832*^9}, {
  3.602610236368999*^9, 3.602610238967491*^9}}],

Cell[BoxData["44"], "Output",
 CellChangeTimes->{3.602610198235241*^9, 3.6026102396378593`*^9, 
  3.6026104189785843`*^9, 3.602611726046775*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TreeForm", "[", "hierarchicalData", "]"}]], "Input",
 CellChangeTimes->{{3.6026102737470016`*^9, 3.602610277966423*^9}, {
  3.602610332366975*^9, 3.602610333230929*^9}}],

Cell[BoxData[
 GraphicsBox[
  TagBox[GraphicsComplexBox[{{2.282543646357307, 2.02892768565094}, {
    0.6763092285503133, 1.3526184571006268`}, {0., 0.6763092285503134}, {
    0.6763092285503133, 0.6763092285503134}, {1.3526184571006266`, 
    0.6763092285503134}, {2.3670822999260968`, 1.3526184571006268`}, {
    2.02892768565094, 0.6763092285503134}, {2.705236914201253, 
    0.6763092285503134}, {3.8887780641643017`, 1.3526184571006268`}, {
    3.3815461427515667`, 0.6763092285503134}, {3.3815461427515667`, 0.}, {
    4.396009985577036, 0.6763092285503134}, {4.05785537130188, 0.}, {
    4.7341645998521935`, 0.}}, {
     {RGBColor[0.55, 0.45, 0.45], 
      LineBox[{{1, 2}, {1, 6}, {1, 9}, {2, 3}, {2, 4}, {2, 5}, {6, 7}, {6, 
       8}, {9, 10}, {9, 12}, {10, 11}, {12, 13}, {12, 14}}]}, {
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 1],
        TagBox[
         RowBox[{"{", 
           RowBox[{
             RowBox[{"{", 
               RowBox[{"4", ",", "3", ",", "2"}], "}"}], ",", 
             RowBox[{"{", 
               RowBox[{"6", ",", "5"}], "}"}], ",", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", "7", "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"9", ",", "8"}], "}"}]}], "}"}]}], "}"}], 
         HoldForm]],
       Annotation[#, 
        HoldForm[{{4, 3, 2}, {6, 5}, {{7}, {9, 8}}}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 2],
        TagBox[
         RowBox[{"{", 
           RowBox[{"4", ",", "3", ",", "2"}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{4, 3, 2}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["4",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 3],
        TagBox["4", HoldForm]],
       Annotation[#, 
        HoldForm[4], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["3",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 4],
        TagBox["3", HoldForm]],
       Annotation[#, 
        HoldForm[3], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["2",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 5],
        TagBox["2", HoldForm]],
       Annotation[#, 
        HoldForm[2], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 6],
        TagBox[
         RowBox[{"{", 
           RowBox[{"6", ",", "5"}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{6, 5}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["6",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 7],
        TagBox["6", HoldForm]],
       Annotation[#, 
        HoldForm[6], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["5",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 8],
        TagBox["5", HoldForm]],
       Annotation[#, 
        HoldForm[5], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 9],
        TagBox[
         RowBox[{"{", 
           RowBox[{
             RowBox[{"{", "7", "}"}], ",", 
             RowBox[{"{", 
               RowBox[{"9", ",", "8"}], "}"}]}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{{7}, {9, 8}}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 10],
        TagBox[
         RowBox[{"{", "7", "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{7}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["7",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 11],
        TagBox["7", HoldForm]],
       Annotation[#, 
        HoldForm[7], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox["List", "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 12],
        TagBox[
         RowBox[{"{", 
           RowBox[{"9", ",", "8"}], "}"}], HoldForm]],
       Annotation[#, 
        HoldForm[{9, 8}], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["9",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 13],
        TagBox["9", HoldForm]],
       Annotation[#, 
        HoldForm[9], "Tooltip"]& ], 
      TagBox[
       TooltipBox[InsetBox[
         FrameBox[
          StyleBox[
           TagBox["8",
            HoldForm], "StandardForm", "Output",
           StripOnInput->False,
           LineColor->GrayLevel[0],
           FrontFaceColor->GrayLevel[0],
           BackFaceColor->GrayLevel[0],
           GraphicsColor->GrayLevel[0],
           FontSize->Scaled[0.05],
           FontColor->GrayLevel[0]],
          Background->RGBColor[1., 1., 0.871],
          FrameStyle->GrayLevel[0.5],
          StripOnInput->False], 14],
        TagBox["8", HoldForm]],
       Annotation[#, 
        HoldForm[8], "Tooltip"]& ]}}],
   Annotation[#, 
    VertexCoordinateRules -> {{2.282543646357307, 2.02892768565094}, {
     0.6763092285503133, 1.3526184571006268`}, {0., 0.6763092285503134}, {
     0.6763092285503133, 0.6763092285503134}, {1.3526184571006266`, 
     0.6763092285503134}, {2.3670822999260968`, 1.3526184571006268`}, {
     2.02892768565094, 0.6763092285503134}, {2.705236914201253, 
     0.6763092285503134}, {3.8887780641643017`, 1.3526184571006268`}, {
     3.3815461427515667`, 0.6763092285503134}, {3.3815461427515667`, 0.}, {
     4.396009985577036, 0.6763092285503134}, {4.05785537130188, 0.}, {
     4.7341645998521935`, 0.}}]& ],
  AspectRatio->NCache[2 Rational[2, 13]^Rational[1, 2], 0.7844645405527362],
  FrameTicks->Automatic,
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{3.602610278572262*^9, 3.602610333737166*^9, 
  3.60261042152422*^9, 3.602611726108612*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Extending Squarify", "Subsection",
 CellChangeTimes->{{3.602610520774729*^9, 3.6026105236066236`*^9}}],

Cell["\<\
Given a list of areas, BaseLayerQ returns True if all the elements are \
numbers (and therefore Squarify can be used to layout the rectangle).\
\>", "Text",
 CellChangeTimes->{{3.6026108273875017`*^9, 3.602610886686378*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"BaseLayerQ", "[", "areas_List", "]"}], ":=", 
  RowBox[{"And", "@@", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"NumberQ", "[", "#", "]"}], "&"}], "/@", "areas"}], 
    ")"}]}]}]], "Input",
 CellChangeTimes->{{3.602610889348152*^9, 3.6026108995876617`*^9}, {
  3.6026110931015787`*^9, 3.602611119411306*^9}, {3.602611212968486*^9, 
  3.602611227729227*^9}, {3.602611271645426*^9, 3.6026113847216387`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BaseLayerQ", "[", 
  RowBox[{"{", 
   RowBox[{"3", ",", "4", ",", "5"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.602611121132667*^9, 3.602611126228528*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.602611126797765*^9, {3.602611217495922*^9, 3.602611229809742*^9}, 
   3.602611278993829*^9, {3.602611314952611*^9, 3.60261138693847*^9}, 
   3.6026117261332684`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BaseLayerQ", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", "4", "}"}], ",", 
    RowBox[{"{", "5", "}"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.6026111292660303`*^9, 3.6026111365579433`*^9}}],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{
  3.602611137823739*^9, {3.602611219436079*^9, 3.602611232019762*^9}, 
   3.602611282758754*^9, {3.602611316774756*^9, 3.602611346451148*^9}, 
   3.602611389242201*^9, 3.602611726162127*^9}]
}, Open  ]],

Cell["\<\
ChildArea returns the size of each child in the list, where a child may be \
either a number or a list (itself possibly containing may sub-lists).\
\>", "Text",
 CellChangeTimes->{{3.602611491819154*^9, 3.602611526731435*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChildArea", "[", "areas_List", "]"}], ":=", "\[IndentingNewLine]", 
  
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"NumberQ", "[", 
     RowBox[{"First", "[", "areas", "]"}], "]"}], ",", "\[IndentingNewLine]", 
    "areas", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Total", "[", 
       RowBox[{"#", ",", "\[Infinity]"}], "]"}], "&"}], "/@", "areas"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6026115305364113`*^9, 3.6026115354292517`*^9}, {
  3.6026115729198847`*^9, 3.60261161757955*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ChildArea", "[", "hierarchicalData", "]"}]], "Input",
 CellChangeTimes->{{3.602611598530402*^9, 3.6026116062872753`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"9", ",", "11", ",", "24"}], "}"}]], "Output",
 CellChangeTimes->{{3.602611607085308*^9, 3.6026116198800077`*^9}, {
  3.602611692173368*^9, 3.6026117263031893`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ChildArea", "[", 
  RowBox[{"{", 
   RowBox[{"9", ",", "8"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.602611637879002*^9, 3.602611644158852*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"9", ",", "8"}], "}"}]], "Output",
 CellChangeTimes->{
  3.60261164598666*^9, {3.6026117124922132`*^9, 3.6026117264327106`*^9}}]
}, Open  ]],

Cell[TextData[{
 StyleBox["SquarifyHierarchy",
  FontSlant->"Italic"],
 " works by recursively processing the top-level areas list in depth-first \
search manner. For each layer, the function first tests to see if this layer \
does not have children using the BaseLayerQ function. If it does not, then \
the function calls Squarify. Otherwise, since the layer has children, \
Squarify is called with areas generated by ChildArea. The resulting list of \
rectangles can be recursively processed with their children."
}], "Text",
 CellChangeTimes->{{3.602612123650256*^9, 3.602612125737052*^9}, {
  3.602612498943898*^9, 3.60261255567651*^9}, {3.602612598261819*^9, 
  3.602612715264771*^9}, {3.602612749668528*^9, 3.602612769679336*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SquarifyHierarchy", "[", 
   RowBox[{"parent_Rectangle", ",", "areas_List"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "areas", "]"}], "\[Equal]", "0"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"nothing", " ", "more", " ", "to", " ", "do"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"else", ",", " ", 
      RowBox[{"more", " ", "areas", " ", "to", " ", "process"}]}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"BaseLayerQ", "[", "areas", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Squarify", "[", 
       RowBox[{"parent", ",", "areas"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Block", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"immediateChildRectangles", "=", 
          RowBox[{"Squarify", "[", 
           RowBox[{"parent", ",", 
            RowBox[{"ChildArea", "[", "areas", "]"}]}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Join", "[", "\[IndentingNewLine]", 
         RowBox[{"immediateChildRectangles", ",", "\[IndentingNewLine]", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"SquarifyHierarchy", "[", 
              RowBox[{
               RowBox[{"immediateChildRectangles", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"areas", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "[", "areas", "]"}]}], "}"}]}], 
            "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}]}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 CellChangeTimes->{{3.6026128357892227`*^9, 3.602612849161326*^9}, {
   3.6026132820193367`*^9, 3.602613367745376*^9}, {3.6026134484486837`*^9, 
   3.602613470350045*^9}, {3.602613508062009*^9, 3.6026135102693567`*^9}, {
   3.602613567836361*^9, 3.602613570887844*^9}, {3.602686074137848*^9, 
   3.602686257660129*^9}, {3.6026863065348597`*^9, 3.60268631910083*^9}, {
   3.6026865437814903`*^9, 3.602686558575272*^9}, {3.6026866070461607`*^9, 
   3.6026866494643087`*^9}, {3.602686777936369*^9, 3.602686802761969*^9}, {
   3.602689913829525*^9, 3.602689943798662*^9}, 3.6026900608838377`*^9, {
   3.602690114273408*^9, 3.602690130622517*^9}, {3.6026902226724043`*^9, 
   3.6026902277795677`*^9}, {3.602700308369966*^9, 3.6027003106870127`*^9}, {
   3.60270037922855*^9, 3.602700409545601*^9}}],

Cell[CellGroupData[{

Cell["Example: SquarifyHierarchy", "Subsubsection",
 CellChangeTimes->{{3.602686873412545*^9, 3.60268689855986*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SquarifyHierarchy", "[", 
  RowBox[{
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "4"}], "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "6", ",", "4", ",", "3", ",", "2", ",", "2", ",", "1"}],
     "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.602686906423521*^9, 3.60268693509838*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "2"}], "}"}]}], "]"}], ",", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4"}], "}"}]}], "]"}], ",", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       FractionBox["33", "7"], ",", 
       FractionBox["7", "3"]}], "}"}]}], "]"}], ",", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       FractionBox["33", "7"], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", 
       FractionBox["7", "3"]}], "}"}]}], "]"}], ",", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", 
       FractionBox["7", "3"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       FractionBox["21", "5"], ",", "4"}], "}"}]}], "]"}], ",", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       FractionBox["21", "5"], ",", 
       FractionBox["7", "3"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", 
       FractionBox["31", "9"]}], "}"}]}], "]"}], ",", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       FractionBox["21", "5"], ",", 
       FractionBox["31", "9"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "4"}], "}"}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.602686935973024*^9, 3.602690141447351*^9, 
  3.602700413601993*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SquarifyHierarchy", "[", 
  RowBox[{
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Sqrt", "[", "44", "]"}], ",", 
       RowBox[{"Sqrt", "[", "44", "]"}]}], "}"}]}], "]"}], ",", 
   "hierarchicalData"}], "]"}]], "Input",
 CellChangeTimes->{{3.602686977204221*^9, 3.602686994025972*^9}, {
  3.6026902349652033`*^9, 3.602690236683906*^9}, {3.602690445975925*^9, 
  3.602690451632215*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       FractionBox["10", 
        SqrtBox["11"]], ",", 
       FractionBox[
        RowBox[{"9", " ", 
         SqrtBox["11"]}], "10"]}], "}"}]}], "]"}], ",", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       FractionBox[
        RowBox[{"9", " ", 
         SqrtBox["11"]}], "10"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       FractionBox["10", 
        SqrtBox["11"]], ",", 
       RowBox[{"2", " ", 
        SqrtBox["11"]}]}], "}"}]}], "]"}], ",", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       FractionBox["10", 
        SqrtBox["11"]], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"2", " ", 
        SqrtBox["11"]}], ",", 
       FractionBox["24", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["10", 
           SqrtBox["11"]]}], "+", 
         RowBox[{"2", " ", 
          SqrtBox["11"]}]}]]}], "}"}]}], "]"}], ",", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       FractionBox["70", 
        RowBox[{"9", " ", 
         SqrtBox["11"]}]], ",", 
       FractionBox[
        RowBox[{"18", " ", 
         SqrtBox["11"]}], "35"]}], "}"}]}], "]"}], ",", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       FractionBox[
        RowBox[{"18", " ", 
         SqrtBox["11"]}], "35"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       FractionBox["70", 
        RowBox[{"9", " ", 
         SqrtBox["11"]}]], ",", 
       FractionBox[
        RowBox[{"9", " ", 
         SqrtBox["11"]}], "10"]}], "}"}]}], "]"}], ",", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       FractionBox["70", 
        RowBox[{"9", " ", 
         SqrtBox["11"]}]], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       FractionBox["10", 
        SqrtBox["11"]], ",", 
       FractionBox[
        RowBox[{"9", " ", 
         SqrtBox["11"]}], "10"]}], "}"}]}], "]"}], ",", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       FractionBox[
        RowBox[{"9", " ", 
         SqrtBox["11"]}], "10"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       FractionBox["10", 
        SqrtBox["11"]], ",", 
       FractionBox[
        RowBox[{"3", " ", 
         SqrtBox["11"]}], "2"]}], "}"}]}], "]"}], ",", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       FractionBox[
        RowBox[{"3", " ", 
         SqrtBox["11"]}], "2"]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       FractionBox["10", 
        SqrtBox["11"]], ",", 
       RowBox[{"2", " ", 
        SqrtBox["11"]}]}], "}"}]}], "]"}], ",", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       FractionBox["10", 
        SqrtBox["11"]], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"2", " ", 
        SqrtBox["11"]}], ",", 
       FractionBox["7", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["10", 
           SqrtBox["11"]]}], "+", 
         RowBox[{"2", " ", 
          SqrtBox["11"]}]}]]}], "}"}]}], "]"}], ",", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       FractionBox["10", 
        SqrtBox["11"]], ",", 
       FractionBox["7", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["10", 
           SqrtBox["11"]]}], "+", 
         RowBox[{"2", " ", 
          SqrtBox["11"]}]}]]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"2", " ", 
        SqrtBox["11"]}], ",", 
       FractionBox["24", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["10", 
           SqrtBox["11"]]}], "+", 
         RowBox[{"2", " ", 
          SqrtBox["11"]}]}]]}], "}"}]}], "]"}], ",", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       FractionBox["10", 
        SqrtBox["11"]], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"2", " ", 
        SqrtBox["11"]}], ",", 
       FractionBox["7", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["10", 
           SqrtBox["11"]]}], "+", 
         RowBox[{"2", " ", 
          SqrtBox["11"]}]}]]}], "}"}]}], "]"}], ",", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       FractionBox["10", 
        SqrtBox["11"]], ",", 
       FractionBox["7", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["10", 
           SqrtBox["11"]]}], "+", 
         RowBox[{"2", " ", 
          SqrtBox["11"]}]}]]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"2", " ", 
        SqrtBox["11"]}], ",", 
       FractionBox["16", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["10", 
           SqrtBox["11"]]}], "+", 
         RowBox[{"2", " ", 
          SqrtBox["11"]}]}]]}], "}"}]}], "]"}], ",", 
   RowBox[{"Rectangle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       FractionBox["10", 
        SqrtBox["11"]], ",", 
       FractionBox["16", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["10", 
           SqrtBox["11"]]}], "+", 
         RowBox[{"2", " ", 
          SqrtBox["11"]}]}]]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"2", " ", 
        SqrtBox["11"]}], ",", 
       FractionBox["24", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["10", 
           SqrtBox["11"]]}], "+", 
         RowBox[{"2", " ", 
          SqrtBox["11"]}]}]]}], "}"}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.602686994813365*^9, 3.602690144016282*^9, 
  3.6026902379117126`*^9, 3.602690452249045*^9, 3.602700419556975*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"VisualizeRectangles", "[", "%", "]"}]], "Input",
 CellChangeTimes->{{3.602690249119852*^9, 3.60269025761863*^9}}],

Cell[BoxData[
 GraphicsBox[
  {Opacity[
    NCache[
     Rational[7, 10], 0.7]], EdgeForm[{GrayLevel[0], Thickness[Large]}], 
   RectangleBox[{0, 0}, 
    NCache[{10 11^Rational[-1, 2], Rational[9, 10] 11^Rational[1, 2]}, {
     3.0151134457776365`, 2.98496231131986}]], 
   {RGBColor[0.65, 0.7, 0.7], 
    RectangleBox[
     NCache[{0, Rational[9, 10] 11^Rational[1, 2]}, {0, 2.98496231131986}], 
     NCache[{10 11^Rational[-1, 2], 2 11^Rational[1, 2]}, {
      3.0151134457776365`, 6.6332495807108}]]}, 
   {RGBColor[0.836713, 1., 1.], 
    RectangleBox[NCache[{10 11^Rational[-1, 2], 0}, {3.0151134457776365`, 0}],
      NCache[{2 11^Rational[1, 2], 24/((-10) 11^Rational[-1, 2] + 
       2 11^Rational[1, 2])}, {6.6332495807108, 6.6332495807108005`}]]}, 
   {RGBColor[0.799435, 0.543572, 0.997559], 
    RectangleBox[{0, 0}, 
     NCache[{Rational[70, 9] 11^Rational[-1, 2], Rational[18, 35] 
       11^Rational[1, 2]}, {2.345088235604828, 1.705692749325634}]]}, 
   {RGBColor[0.770565, 0.964309, 0.0442359], 
    RectangleBox[
     NCache[{0, Rational[18, 35] 11^Rational[1, 2]}, {0, 1.705692749325634}], 
     NCache[{Rational[70, 9] 11^Rational[-1, 2], Rational[9, 10] 
       11^Rational[1, 2]}, {2.345088235604828, 2.98496231131986}]]}, 
   {RGBColor[1., 0.709804, 0.709804], 
    RectangleBox[
     NCache[{Rational[70, 9] 11^Rational[-1, 2], 0}, {2.345088235604828, 0}], 
     NCache[{10 11^Rational[-1, 2], Rational[9, 10] 11^Rational[1, 2]}, {
      3.0151134457776365`, 2.98496231131986}]]}, 
   {RGBColor[0.4, 0.4, 0.4], 
    RectangleBox[
     NCache[{0, Rational[9, 10] 11^Rational[1, 2]}, {0, 2.98496231131986}], 
     NCache[{10 11^Rational[-1, 2], Rational[3, 2] 11^Rational[1, 2]}, {
      3.0151134457776365`, 4.9749371855331}]]}, 
   {RGBColor[0.291989, 0.437977, 0.888609], 
    RectangleBox[
     NCache[{0, Rational[3, 2] 11^Rational[1, 2]}, {0, 4.9749371855331}], 
     NCache[{10 11^Rational[-1, 2], 2 11^Rational[1, 2]}, {
      3.0151134457776365`, 6.6332495807108}]]}, 
   {RGBColor[0.800498, 0.201504, 0.192061], 
    RectangleBox[NCache[{10 11^Rational[-1, 2], 0}, {3.0151134457776365`, 0}],
      NCache[{2 11^Rational[1, 2], 7/((-10) 11^Rational[-1, 2] + 
       2 11^Rational[1, 2])}, {6.6332495807108, 1.9346977943739834`}]]}, 
   {RGBColor[0.578462, 0.85539, 0.408855], 
    RectangleBox[
     NCache[{10 11^Rational[-1, 2], 7/((-10) 11^Rational[-1, 2] + 
       2 11^Rational[1, 2])}, {3.0151134457776365`, 1.9346977943739834`}], 
     NCache[{2 11^Rational[1, 2], 24/((-10) 11^Rational[-1, 2] + 
       2 11^Rational[1, 2])}, {6.6332495807108, 6.6332495807108005`}]]}, 
   {RGBColor[0.677263, 0.928423, 0.955287], 
    RectangleBox[NCache[{10 11^Rational[-1, 2], 0}, {3.0151134457776365`, 0}],
      NCache[{2 11^Rational[1, 2], 7/((-10) 11^Rational[-1, 2] + 
       2 11^Rational[1, 2])}, {6.6332495807108, 1.9346977943739834`}]]}, 
   {RGBColor[0.658708, 0.492173, 0.842842], 
    RectangleBox[
     NCache[{10 11^Rational[-1, 2], 7/((-10) 11^Rational[-1, 2] + 
       2 11^Rational[1, 2])}, {3.0151134457776365`, 1.9346977943739834`}], 
     NCache[{2 11^Rational[1, 2], 16/((-10) 11^Rational[-1, 2] + 
       2 11^Rational[1, 2])}, {6.6332495807108, 4.422166387140534}]]}, 
   {RGBColor[0.628274, 0.850553, 0.0782731], 
    RectangleBox[
     NCache[{10 11^Rational[-1, 2], 16/((-10) 11^Rational[-1, 2] + 
       2 11^Rational[1, 2])}, {3.0151134457776365`, 4.422166387140534}], 
     NCache[{2 11^Rational[1, 2], 24/((-10) 11^Rational[-1, 2] + 
       2 11^Rational[1, 2])}, {6.6332495807108, 6.6332495807108005`}]]}},
  Axes->True,
  GridLines->Automatic]], "Output",
 CellChangeTimes->{3.602690258134375*^9, 3.6026904583824*^9, 
  3.602700424142824*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Dealing with User Data", "Section",
 CellChangeTimes->{{3.6025124987310333`*^9, 3.602512501265431*^9}, 
   3.60251281896754*^9}],

Cell[CellGroupData[{

Cell["Cleaning Data", "Subsection",
 CellChangeTimes->{{3.602699510920231*^9, 3.6026995155353727`*^9}}],

Cell["\<\
User data may include values that cannot be represented within a treemap \
(e.g. negative numbers). The function CleanData removes values from a \
hierarchy that cannot be represented, as well as returning lists of numbers \
in sorted order (descending). The later change is based on the original paper\
\[CloseCurlyQuote]s assertion that descending order for numbers produces the \
most aesthetic results.\
\>", "Text",
 CellChangeTimes->{{3.602699524202982*^9, 3.6026995994651737`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ValidNonBaseLayerQ", "[", "areas_List", "]"}], ":=", 
  RowBox[{"VectorQ", "[", 
   RowBox[{"areas", ",", "ListQ"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.602610889348152*^9, 3.6026108995876617`*^9}, {
  3.6026110931015787`*^9, 3.602611119411306*^9}, {3.602611212968486*^9, 
  3.602611227729227*^9}, {3.602611271645426*^9, 3.6026113847216387`*^9}, {
  3.6026997529899693`*^9, 3.602699765262841*^9}, {3.602699829433758*^9, 
  3.6026998486836977`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ValidNonBaseLayerQ", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"3", ",", "4"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"5", ",", "6", ",", "7"}], "}"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.6026998515733423`*^9, 3.6026998615455723`*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.602699862159512*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ValidNonBaseLayerQ", "[", 
  RowBox[{"{", 
   RowBox[{"3", ",", "4"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.60269986409614*^9, 3.602699868284793*^9}}],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{3.602699868849471*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"CleanData", "[", "areas_List", "]"}], ":=", "\[IndentingNewLine]", 
  
  RowBox[{"Which", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BaseLayerQ", "[", "areas", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Sort", "[", 
     RowBox[{
      RowBox[{"Select", "[", 
       RowBox[{"areas", ",", 
        RowBox[{
         RowBox[{"#", ">", "0"}], "&"}]}], "]"}], ",", "Greater"}], "]"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"ValidNonBaseLayerQ", "[", "areas", "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"CleanData", "[", "#", "]"}], "&"}], "/@", "areas"}], ",", 
    "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", 
    RowBox[{"Abort", "[", "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.602699603894025*^9, 3.602699643206688*^9}, {
  3.602699685130082*^9, 3.60269969239392*^9}, {3.6026998867383833`*^9, 
  3.602699950141202*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CleanData", "[", "hierarchicalData", "]"}]], "Input",
 CellChangeTimes->{{3.602699952356661*^9, 3.602699955234482*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"4", ",", "3", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "7", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"9", ",", "8"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.602699955747117*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CleanData", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"2", ",", "3", ",", 
      RowBox[{"-", "1"}], ",", "4"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"6", ",", "5"}], "}"}], ",", 
    RowBox[{"{", "7", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"8", ",", "9", ",", "0"}], "}"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.602699969024702*^9, 3.602700010034808*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"4", ",", "3", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "5"}], "}"}], ",", 
   RowBox[{"{", "7", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"9", ",", "8"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.602699994106532*^9, 3.602700010528747*^9}}]
}, Open  ]],

Cell["\<\
Treemap is a wrapper around SquarifyHierarchy that first filters a list of \
values using CleanData. Then, Treemap scales the values to the area of the \
parent rectangle (a rectangle with width and height provided as parameters). \
The result is returned as a graphic objects generated via VisualizeRectangles.\
\>", "Text",
 CellChangeTimes->{{3.602526350709094*^9, 3.6025264182344313`*^9}, {
  3.60252645425872*^9, 3.602526490762808*^9}, {3.60252687868268*^9, 
  3.602526902422494*^9}, {3.602699403898952*^9, 3.6026994787608547`*^9}, {
  3.60270014023281*^9, 3.602700228857696*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Treemap", "[", 
   RowBox[{"width_Integer", ",", "height_Integer", ",", "values_List"}], 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Block", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"safeValues", "=", 
       RowBox[{"CleanData", "[", "values", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"parentArea", "=", 
       RowBox[{"width", "*", "height"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"VisualizeRectangles", "[", "\[IndentingNewLine]", 
     RowBox[{"SquarifyHierarchy", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Rectangle", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"width", ",", "height"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"safeValues", "*", 
        RowBox[{"(", 
         RowBox[{"parentArea", "/", 
          RowBox[{"Total", "[", 
           RowBox[{"safeValues", ",", "\[Infinity]"}], "]"}]}], ")"}]}]}], 
      "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.602526506817182*^9, 3.602526553463749*^9}, {
  3.6025266266218863`*^9, 3.602526628261053*^9}, {3.602526667828948*^9, 
  3.602526778576936*^9}, {3.6025268489014587`*^9, 3.6025268675483503`*^9}, {
  3.602526962997233*^9, 3.602526963214738*^9}, {3.602691128007341*^9, 
  3.602691128694412*^9}, {3.602700041674602*^9, 3.602700045340198*^9}, {
  3.602700098799645*^9, 3.6027001008327503`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Example: Treemap", "Subsection",
 CellChangeTimes->{{3.602526799642879*^9, 3.602526819825087*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Treemap", "[", 
  RowBox[{"320", ",", "240", ",", 
   RowBox[{"{", 
    RowBox[{
    "858", ",", "1020", ",", "1119", ",", "715", ",", "976", ",", "857", ",", 
     "900"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.602526824357456*^9, 3.6025268357201*^9}, {
  3.602526908921444*^9, 3.602526943989896*^9}}],

Cell[BoxData[
 GraphicsBox[
  {Opacity[
    NCache[
     Rational[7, 10], 0.7]], EdgeForm[{GrayLevel[0], Thickness[Large]}], 
   RectangleBox[{0, 0}, 
    NCache[{Rational[136896, 1289], Rational[89520, 713]}, {106.2032583397983,
      125.55399719495091`}]], 
   {RGBColor[0.65, 0.7, 0.7], 
    RectangleBox[NCache[{0, Rational[89520, 713]}, {0, 125.55399719495091`}], 
     NCache[{Rational[136896, 1289], 240}, {106.2032583397983, 240}]]}, 
   {RGBColor[0.836713, 1., 1.], 
    RectangleBox[NCache[{Rational[136896, 1289], 0}, {106.2032583397983, 0}], 
     NCache[{Rational[131446720, 604541], Rational[225120, 2153]}, {
      217.4322667941463, 104.56107756618671`}]]}, 
   {RGBColor[0.799435, 0.543572, 0.997559], 
    RectangleBox[
     NCache[{Rational[131446720, 604541], 0}, {217.4322667941463, 0}], 
     NCache[{320, Rational[225120, 2153]}, {320, 104.56107756618671`}]]}, 
   {RGBColor[0.770565, 0.964309, 0.0442359], 
    RectangleBox[
     NCache[{Rational[136896, 1289], Rational[225120, 2153]}, {
      106.2032583397983, 104.56107756618671`}], 
     NCache[{Rational[94851392, 522045], 240}, {
      181.69198440747445`, 240}]]}, 
   {RGBColor[1., 0.709804, 0.709804], 
    RectangleBox[
     NCache[{Rational[94851392, 522045], Rational[225120, 2153]}, {
      181.69198440747445`, 104.56107756618671`}], 
     NCache[{320, Rational[50315820, 282043]}, {
      320, 178.39769113220325`}]]}, 
   {RGBColor[0.4, 0.4, 0.4], 
    RectangleBox[
     NCache[{Rational[94851392, 522045], Rational[50315820, 282043]}, {
      181.69198440747445`, 178.39769113220325`}], {320, 240}]}},
  Axes->True,
  GridLines->Automatic]], "Output",
 CellChangeTimes->{{3.602526944948555*^9, 3.602526965804633*^9}, 
   3.6026092469713707`*^9, 3.602611726519952*^9, 3.602691132728582*^9, 
   3.6027000545040417`*^9, 3.602700103931768*^9, 3.602700428820424*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Treemap", "[", 
  RowBox[{"320", ",", "240", ",", "hierarchicalData"}], "]"}]], "Input",
 CellChangeTimes->{{3.602691138431418*^9, 3.602691143180431*^9}}],

Cell[BoxData[
 GraphicsBox[
  {Opacity[
    NCache[
     Rational[7, 10], 0.7]], EdgeForm[{GrayLevel[0], Thickness[Large]}], 
   RectangleBox[{0, 0}, 
    NCache[{Rational[1600, 11], 108}, {145.45454545454547`, 108}]], 
   {RGBColor[0.65, 0.7, 0.7], 
    RectangleBox[{0, 108}, 
     NCache[{Rational[1600, 11], 240}, {145.45454545454547`, 240}]]}, 
   {RGBColor[0.836713, 1., 1.], 
    RectangleBox[
     NCache[{Rational[1600, 11], 0}, {
      145.45454545454547`, 0}], {320, 240}]}, 
   {RGBColor[0.799435, 0.543572, 0.997559], 
    RectangleBox[{0, 0}, 
     NCache[{Rational[6400, 99], 108}, {64.64646464646465, 108}]]}, 
   {RGBColor[0.770565, 0.964309, 0.0442359], 
    RectangleBox[NCache[{Rational[6400, 99], 0}, {64.64646464646465, 0}], 
     NCache[{Rational[1600, 11], Rational[324, 5]}, {145.45454545454547`, 
      64.8}]]}, 
   {RGBColor[1., 0.709804, 0.709804], 
    RectangleBox[
     NCache[{Rational[6400, 99], Rational[324, 5]}, {64.64646464646465, 
      64.8}], NCache[{Rational[1600, 11], 108}, {145.45454545454547`, 108}]]}, 
   {RGBColor[0.4, 0.4, 0.4], 
    RectangleBox[{0, 108}, 
     NCache[{Rational[9600, 121], 240}, {79.33884297520662, 240}]]}, 
   {RGBColor[0.291989, 0.437977, 0.888609], 
    RectangleBox[NCache[{Rational[9600, 121], 108}, {79.33884297520662, 108}],
      NCache[{Rational[1600, 11], 240}, {145.45454545454547`, 240}]]}, 
   {RGBColor[0.800498, 0.201504, 0.192061], 
    RectangleBox[
     NCache[{Rational[1600, 11], 0}, {145.45454545454547`, 0}], {320, 70}]}, 
   {RGBColor[0.578462, 0.85539, 0.408855], 
    RectangleBox[
     NCache[{Rational[1600, 11], 70}, {
      145.45454545454547`, 70}], {320, 240}]}, 
   {RGBColor[0.677263, 0.928423, 0.955287], 
    RectangleBox[
     NCache[{Rational[1600, 11], 0}, {145.45454545454547`, 0}], {320, 70}]}, 
   {RGBColor[0.658708, 0.492173, 0.842842], 
    RectangleBox[NCache[{Rational[1600, 11], 70}, {145.45454545454547`, 70}], 
     NCache[{Rational[44480, 187], 240}, {237.86096256684493`, 240}]]}, 
   {RGBColor[0.628274, 0.850553, 0.0782731], 
    RectangleBox[
     NCache[{Rational[44480, 187], 70}, {
      237.86096256684493`, 70}], {320, 240}]}},
  Axes->True,
  GridLines->Automatic]], "Output",
 CellChangeTimes->{3.602691143878603*^9, 3.602700060012258*^9, 
  3.6027001080145073`*^9, 3.602700432481275*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["References", "Section",
 CellChangeTimes->{{3.60251282128321*^9, 3.602512836855584*^9}}],

Cell[TextData[{
 "\t",
 StyleBox["1",
  FontVariations->{"CompatibilityType"->"Superscript"}],
 "\t",
 "M",
 ".",
 " ",
 "Bruls",
 ",",
 " ",
 "K",
 ".",
 " ",
 "Huizing",
 ",",
 " ",
 "and",
 " ",
 "J",
 ".",
 " ",
 "van",
 " ",
 "Wijk",
 ",",
 " ",
 "\"Squarified treemaps,\"",
 " ",
 "in",
 " ",
 "Proceedings",
 " ",
 "of",
 " ",
 "the",
 " ",
 "Joint",
 " ",
 "Eurographics",
 " ",
 "and",
 " ",
 "IEEE",
 " ",
 "TCVG",
 " ",
 "Symposium",
 " ",
 "on",
 " ",
 "Visualization",
 ",",
 " ",
 "pp",
 ".",
 " ",
 "33",
 "-",
 "42",
 ",",
 " ",
 "2000.",
 " "
}], "Reference",
 Editable->False,
 TaggingRules->{ReferenceNoteData -> ""},
 CellTags->"00007748"],

Cell[TextData[{
 "\t",
 StyleBox["2",
  FontVariations->{"CompatibilityType"->"Superscript"}],
 "\t",
 "http",
 ":",
 "//",
 "en",
 ".",
 "wikipedia",
 ".",
 "org",
 "/",
 "wiki",
 "/",
 "File",
 ":",
 "Tree_Map",
 ".",
 "png"
}], "Reference",
 Editable->False,
 TaggingRules->{ReferenceNoteData -> ""},
 CellTags->"000035FD"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{734, 867},
WindowMargins->{{Automatic, 481}, {Automatic, 64}},
PrintingCopies->1,
PrintingPageRange->{Automatic, Automatic},
PrintingOptions->{"PaperOrientation"->"Portrait",
"PaperSize"->{Automatic, Automatic},
"PostScriptOutputFile"->""},
ShowSelection->True,
FrontEndVersion->"9.0 for Linux x86 (64-bit) (February 7, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Info3602586524-4346083"->{
  Cell[5012, 137, 1533, 27, 101, "Print",
   CellTags->"Info3602586524-4346083"]},
 "00007748"->{
  Cell[100867, 2862, 659, 67, 46, "Reference",
   CellTags->"00007748"]},
 "000035FD"->{
  Cell[101529, 2931, 326, 24, 30, "Reference",
   CellTags->"000035FD"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Info3602586524-4346083", 102383, 2975},
 {"00007748", 102481, 2978},
 {"000035FD", 102570, 2981}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 100, 1, 93, "Title"],
Cell[682, 25, 183, 5, 51, "Subtitle"],
Cell[868, 32, 116, 1, 31, "Subsubtitle"],
Cell[CellGroupData[{
Cell[1009, 37, 93, 1, 81, "Section"],
Cell[1105, 40, 1382, 30, 81, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2524, 75, 99, 1, 81, "Section"],
Cell[2626, 78, 1579, 28, 221, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4242, 111, 131, 3, 81, "Section"],
Cell[4376, 116, 250, 5, 51, "Text"],
Cell[4629, 123, 237, 6, 51, "Text"],
Cell[CellGroupData[{
Cell[4891, 133, 118, 2, 32, "Input"],
Cell[5012, 137, 1533, 27, 101, "Print",
 CellTags->"Info3602586524-4346083"]
}, Open  ]],
Cell[6560, 167, 277, 5, 51, "Text"],
Cell[6840, 174, 658, 17, 143, "Input"],
Cell[7501, 193, 390, 10, 32, "Input"],
Cell[7894, 205, 389, 10, 32, "Input"],
Cell[8286, 217, 252, 6, 32, "Input"],
Cell[8541, 225, 419, 7, 91, "Text"],
Cell[8963, 234, 1066, 27, 143, "Input"],
Cell[CellGroupData[{
Cell[10054, 265, 117, 1, 45, "Subsection"],
Cell[CellGroupData[{
Cell[10196, 270, 671, 19, 99, "Input"],
Cell[10870, 291, 205, 5, 49, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[11136, 303, 109, 1, 81, "Section"],
Cell[11248, 306, 516, 10, 91, "Text"],
Cell[11767, 318, 1323, 28, 231, "Input"],
Cell[13093, 348, 112, 1, 31, "Text"],
Cell[CellGroupData[{
Cell[13230, 353, 1318, 38, 143, "Input"],
Cell[14551, 393, 1043, 21, 267, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[15643, 420, 106, 1, 81, "Section"],
Cell[15752, 423, 619, 10, 131, "Text"],
Cell[16374, 435, 553, 9, 111, "Text"],
Cell[CellGroupData[{
Cell[16952, 448, 104, 1, 45, "Subsection"],
Cell[17059, 451, 251, 6, 32, "Input"],
Cell[17313, 459, 2278, 60, 363, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19628, 524, 105, 1, 45, "Subsection"],
Cell[19736, 527, 251, 6, 32, "Input"],
Cell[19990, 535, 2324, 61, 341, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22351, 601, 140, 3, 45, "Subsection"],
Cell[CellGroupData[{
Cell[22516, 608, 2978, 74, 429, "Input"],
Cell[25497, 684, 2844, 67, 100, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[28402, 758, 105, 1, 81, "Section"],
Cell[28510, 761, 272, 5, 51, "Text"],
Cell[CellGroupData[{
Cell[28807, 770, 868, 23, 165, "Input"],
Cell[29678, 795, 1111, 24, 267, "Output"]
}, Open  ]],
Cell[30804, 822, 710, 11, 131, "Text"],
Cell[31517, 835, 188, 4, 32, "Input"],
Cell[31708, 841, 332, 9, 55, "Input"],
Cell[32043, 852, 442, 9, 77, "Input"],
Cell[32488, 863, 327, 6, 71, "Text"],
Cell[32818, 871, 1955, 47, 319, "Input"],
Cell[34776, 920, 298, 6, 51, "Text"],
Cell[35077, 928, 181, 4, 32, "Input"],
Cell[35261, 934, 181, 4, 32, "Input"],
Cell[CellGroupData[{
Cell[35467, 942, 117, 1, 45, "Subsection"],
Cell[35587, 945, 179, 4, 31, "Text"],
Cell[CellGroupData[{
Cell[35791, 953, 451, 12, 55, "Input"],
Cell[36245, 967, 522, 16, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36804, 988, 135, 2, 32, "Input"],
Cell[36942, 992, 162, 3, 49, "Output"]
}, Open  ]],
Cell[37119, 998, 186, 4, 51, "Text"],
Cell[CellGroupData[{
Cell[37330, 1006, 453, 13, 55, "Input"],
Cell[37786, 1021, 142, 2, 32, "Output"]
}, Open  ]],
Cell[37943, 1026, 170, 3, 31, "Text"],
Cell[CellGroupData[{
Cell[38138, 1033, 434, 12, 55, "Input"],
Cell[38575, 1047, 628, 20, 49, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39240, 1072, 137, 2, 32, "Input"],
Cell[39380, 1076, 143, 3, 49, "Output"]
}, Open  ]],
Cell[39538, 1082, 183, 4, 31, "Text"],
Cell[CellGroupData[{
Cell[39746, 1090, 456, 13, 55, "Input"],
Cell[40205, 1105, 166, 3, 49, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[40432, 1115, 176, 4, 81, "Section"],
Cell[40611, 1121, 602, 10, 111, "Text"],
Cell[41216, 1133, 309, 5, 71, "Text"],
Cell[41528, 1140, 1239, 35, 165, "Input"],
Cell[42770, 1177, 394, 7, 71, "Text"],
Cell[43167, 1186, 2394, 59, 341, "Input"],
Cell[CellGroupData[{
Cell[45586, 1249, 117, 1, 45, "Subsection"],
Cell[CellGroupData[{
Cell[45728, 1254, 532, 16, 55, "Input"],
Cell[46263, 1272, 295, 8, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46595, 1285, 595, 16, 77, "Input"],
Cell[47193, 1303, 421, 10, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47651, 1318, 969, 30, 138, "Input"],
Cell[48623, 1350, 301, 9, 49, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48961, 1364, 498, 15, 55, "Input"],
Cell[49462, 1381, 274, 8, 32, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[49797, 1396, 103, 1, 81, "Section"],
Cell[49903, 1399, 302, 5, 71, "Text"],
Cell[50208, 1406, 340, 8, 55, "Input"],
Cell[50551, 1416, 1472, 35, 341, "Input"],
Cell[CellGroupData[{
Cell[52048, 1455, 105, 1, 45, "Subsection"],
Cell[CellGroupData[{
Cell[52178, 1460, 424, 12, 32, "Input"],
Cell[52605, 1474, 1683, 57, 162, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[54325, 1536, 138, 2, 32, "Input"],
Cell[54466, 1540, 1209, 28, 267, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[55736, 1575, 107, 1, 81, "Section"],
Cell[55846, 1578, 543, 9, 91, "Text"],
Cell[CellGroupData[{
Cell[56414, 1591, 106, 1, 45, "Subsection"],
Cell[56523, 1594, 516, 10, 91, "Text"],
Cell[57042, 1606, 255, 7, 31, "Text"],
Cell[57300, 1615, 513, 15, 32, "Input"],
Cell[CellGroupData[{
Cell[57838, 1634, 223, 4, 32, "Input"],
Cell[58064, 1640, 144, 2, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58245, 1647, 193, 3, 32, "Input"],
Cell[58441, 1652, 11110, 307, 312, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[69600, 1965, 108, 1, 45, "Subsection"],
Cell[69711, 1968, 234, 4, 51, "Text"],
Cell[69948, 1974, 456, 11, 32, "Input"],
Cell[CellGroupData[{
Cell[70429, 1989, 186, 4, 32, "Input"],
Cell[70618, 1995, 221, 4, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[70876, 2004, 230, 6, 32, "Input"],
Cell[71109, 2012, 243, 4, 32, "Output"]
}, Open  ]],
Cell[71367, 2019, 236, 4, 51, "Text"],
Cell[71606, 2025, 586, 15, 121, "Input"],
Cell[CellGroupData[{
Cell[72217, 2044, 145, 2, 32, "Input"],
Cell[72365, 2048, 204, 4, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[72606, 2057, 175, 4, 32, "Input"],
Cell[72784, 2063, 167, 4, 32, "Output"]
}, Open  ]],
Cell[72966, 2070, 736, 12, 131, "Text"],
Cell[73705, 2084, 2878, 60, 495, "Input"],
Cell[CellGroupData[{
Cell[76608, 2148, 116, 1, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[76749, 2153, 430, 12, 32, "Input"],
Cell[77182, 2167, 1681, 57, 162, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[78900, 2229, 520, 14, 55, "Input"],
Cell[79423, 2245, 5948, 219, 728, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[85408, 2469, 137, 2, 32, "Input"],
Cell[85548, 2473, 3701, 70, 381, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[89322, 2551, 134, 2, 81, "Section"],
Cell[CellGroupData[{
Cell[89481, 2557, 103, 1, 45, "Subsection"],
Cell[89587, 2560, 498, 8, 111, "Text"],
Cell[90088, 2570, 488, 9, 32, "Input"],
Cell[CellGroupData[{
Cell[90601, 2583, 300, 8, 32, "Input"],
Cell[90904, 2593, 73, 1, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[91014, 2599, 183, 4, 32, "Input"],
Cell[91200, 2605, 74, 1, 32, "Output"]
}, Open  ]],
Cell[91289, 2609, 963, 23, 209, "Input"],
Cell[CellGroupData[{
Cell[92277, 2636, 143, 2, 32, "Input"],
Cell[92423, 2640, 361, 12, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[92821, 2657, 425, 12, 32, "Input"],
Cell[93249, 2671, 340, 10, 32, "Output"]
}, Open  ]],
Cell[93604, 2684, 595, 9, 91, "Text"],
Cell[94202, 2695, 1610, 37, 253, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[95849, 2737, 104, 1, 45, "Subsection"],
Cell[CellGroupData[{
Cell[95978, 2742, 336, 8, 32, "Input"],
Cell[96317, 2752, 1855, 39, 286, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[98209, 2796, 178, 3, 32, "Input"],
Cell[98390, 2801, 2319, 51, 319, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[100770, 2859, 94, 1, 81, "Section"],
Cell[100867, 2862, 659, 67, 46, "Reference",
 CellTags->"00007748"],
Cell[101529, 2931, 326, 24, 30, "Reference",
 CellTags->"000035FD"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
